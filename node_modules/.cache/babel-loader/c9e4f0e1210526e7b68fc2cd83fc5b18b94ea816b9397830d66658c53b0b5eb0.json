{"ast":null,"code":"// Lightweight API helper for the frontend to talk to the local Express API.\nconst API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:4000';\nasync function request(path, opts = {}) {\n  // include Authorization Bearer token from localStorage when present\n  const headers = {\n    'Content-Type': 'application/json',\n    ...(opts.headers || {})\n  };\n  try {\n    let tokenRaw = localStorage.getItem('pt_admin_token');\n    if (tokenRaw) {\n      try {\n        tokenRaw = JSON.parse(tokenRaw);\n      } catch (e) {/* keep raw if not JSON */}\n      if (tokenRaw) headers['Authorization'] = `Bearer ${tokenRaw}`;\n    }\n  } catch (e) {}\n  const res = await fetch(`${API_BASE}${path}`, {\n    headers,\n    ...opts\n  });\n  if (!res.ok) {\n    const text = await res.text().catch(() => null);\n    throw new Error(text || res.statusText || 'API error');\n  }\n  // Try to parse JSON, otherwise return null\n  const ct = res.headers.get('content-type') || '';\n  if (ct.includes('application/json')) return res.json();\n  return null;\n}\nexport async function fetchBooks() {\n  return request('/api/books');\n}\nexport async function fetchAuthor() {\n  return request('/api/author');\n}\nexport async function saveAuthor(data) {\n  return request('/api/author', {\n    method: 'POST',\n    body: JSON.stringify(data)\n  });\n}\nexport async function toggleFeatured(bookId) {\n  return request(`/api/books/${bookId}/toggle-featured`, {\n    method: 'POST'\n  });\n}\nexport async function adminLogin(id, password) {\n  return request('/api/admin/login', {\n    method: 'POST',\n    body: JSON.stringify({\n      id,\n      password\n    })\n  });\n}\nexport async function createOrder(payload) {\n  return request('/api/orders', {\n    method: 'POST',\n    body: JSON.stringify(payload)\n  });\n}\nexport async function fetchOrders() {\n  return request('/api/orders');\n}\nexport async function updateOrderStatus(id, status) {\n  return request(`/api/orders/${id}/status`, {\n    method: 'PUT',\n    body: JSON.stringify({\n      status\n    })\n  });\n}\nexport default {\n  fetchBooks,\n  fetchAuthor,\n  saveAuthor,\n  toggleFeatured,\n  adminLogin,\n  createOrder,\n  fetchOrders,\n  updateOrderStatus\n};","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_URL","request","path","opts","headers","tokenRaw","localStorage","getItem","JSON","parse","e","res","fetch","ok","text","catch","Error","statusText","ct","get","includes","json","fetchBooks","fetchAuthor","saveAuthor","data","method","body","stringify","toggleFeatured","bookId","adminLogin","id","password","createOrder","payload","fetchOrders","updateOrderStatus","status"],"sources":["/Users/viveksingh/Desktop/book-frontend/src/lib/api.js"],"sourcesContent":["// Lightweight API helper for the frontend to talk to the local Express API.\nconst API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:4000';\n\nasync function request(path, opts = {}){\n  // include Authorization Bearer token from localStorage when present\n  const headers = { 'Content-Type': 'application/json', ...(opts.headers || {}) };\n  try{\n    let tokenRaw = localStorage.getItem('pt_admin_token');\n    if(tokenRaw){\n      try{ tokenRaw = JSON.parse(tokenRaw); }catch(e){ /* keep raw if not JSON */ }\n      if(tokenRaw) headers['Authorization'] = `Bearer ${tokenRaw}`;\n    }\n  }catch(e){}\n\n  const res = await fetch(`${API_BASE}${path}`, {\n    headers,\n    ...opts\n  });\n  if(!res.ok){\n    const text = await res.text().catch(()=>null);\n    throw new Error(text || res.statusText || 'API error');\n  }\n  // Try to parse JSON, otherwise return null\n  const ct = res.headers.get('content-type') || '';\n  if(ct.includes('application/json')) return res.json();\n  return null;\n}\n\nexport async function fetchBooks(){ return request('/api/books'); }\nexport async function fetchAuthor(){ return request('/api/author'); }\nexport async function saveAuthor(data){ return request('/api/author', { method: 'POST', body: JSON.stringify(data) }); }\nexport async function toggleFeatured(bookId){ return request(`/api/books/${bookId}/toggle-featured`, { method: 'POST' }); }\nexport async function adminLogin(id, password){\n  return request('/api/admin/login', { method: 'POST', body: JSON.stringify({ id, password }) });\n}\nexport async function createOrder(payload){ return request('/api/orders', { method: 'POST', body: JSON.stringify(payload) }); }\nexport async function fetchOrders(){ return request('/api/orders'); }\nexport async function updateOrderStatus(id, status){ return request(`/api/orders/${id}/status`, { method: 'PUT', body: JSON.stringify({ status }) }); }\n\nexport default { fetchBooks, fetchAuthor, saveAuthor, toggleFeatured, adminLogin, createOrder, fetchOrders, updateOrderStatus };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}