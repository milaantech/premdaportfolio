{"ast":null,"code":"var _jsxFileName = \"/Users/viveksingh/Desktop/book-frontend/src/components/Admin.js\",\n  _s = $RefreshSig$();\n// import React, { useState, useEffect } from 'react';\n// import api from '../lib/api';\n// import { useNavigate } from 'react-router-dom';\n// import { motion } from 'framer-motion';\n// import OrdersAdmin from './OrdersAdmin';\n// import ReactMarkdown from 'react-markdown';\n// import remarkGfm from 'remark-gfm';\n// import ReactQuill from 'react-quill';\n// import 'react-quill/dist/quill.snow.css';\n\n// export default function Admin({ books, setBooks, showAlert, logoutAdmin, author, setAuthor }){\n//   const navigate = useNavigate();\n//   const [orderCount, setOrderCount] = React.useState(0);\n//   const [queuedCount, setQueuedCount] = React.useState(0);\n//   const [editing, setEditing] = useState(null);\n//   const [activeTab, setActiveTab] = useState('books'); // 'books' | 'about'\n//   const asideRef = React.createRef();\n\n//   const existingGenres = [...new Set(books.map(b => b.genre).filter(g => g))].sort();\n\n//   const empty = {\n//     title:'', subtitle:'', price:'',\n//     images: ['https://placehold.co/800x1200?text=New+Book+Cover'],\n//     description:'', genre:'', pages:0, isbn:'', pubDate: new Date().toISOString().slice(0, 10)\n//   };\n//   const [form, setForm] = useState(empty);\n\n//   useEffect(()=>{\n//     if(editing) {\n//       setForm({...editing, images: editing.images || [empty.images[0]]});\n//     } else {\n//       setForm(empty);\n//     }\n//   }, [editing]);\n\n//   // Load order counts for badge\n//   async function loadOrderCounts(){\n//     try{\n//       const orders = await api.fetchOrders();\n//       setOrderCount(Array.isArray(orders) ? orders.length : 0);\n//     }catch(e){ setOrderCount(0); }\n//     try{\n//       const q = await api.fetchOrderQueue();\n//       setQueuedCount(Array.isArray(q) ? q.length : 0);\n//     }catch(e){ setQueuedCount(0); }\n//   }\n\n//   React.useEffect(()=>{ loadOrderCounts(); }, []);\n\n//   function handleImageChange(index, value) {\n//     const newImages = [...form.images];\n//     newImages[index] = value;\n//     setForm({...form, images: newImages });\n//   }\n\n//   function addImage() {\n//     setForm({...form, images: [...form.images, ''] });\n//   }\n\n//   function removeImage(index) {\n//     if (form.images.length === 1) {\n//       return showAlert('Error', 'A book must have at least one image (the primary cover).');\n//     }\n//     const newImages = form.images.filter((_, i) => i !== index);\n//     setForm({...form, images: newImages });\n//   }\n\n//   function save(){\n//     const cleanedImages = form.images.filter(img => img && img.trim());\n\n//     if(!form.title || !form.price || !form.genre) return showAlert('Validation Error', 'Book Title, Price, and Genre are required.');\n//     if(cleanedImages.length === 0) return showAlert('Validation Error', 'At least one cover image URL is required.');\n\n//     const newBook = {\n//       ...form,\n//       images: cleanedImages,\n//       price: Number(form.price),\n//       pages: Number(form.pages)\n//     };\n\n//     // Persist to backend if available. Use either editing._id or editing.id for updates.\n//     (async () => {\n//       try{\n//   let token = null;\n//   try{ token = localStorage.getItem('pt_admin_token'); if(token) token = JSON.parse(token); }catch(e){ /* ignore */ }\n//   const headers = { 'Content-Type': 'application/json' };\n//   if(token) headers['Authorization'] = `Bearer ${token}`;\n\n//         const API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:4000';\n\n//         // Determine if this is an update (has an id or _id) or a create\n//         const editingId = editing && (editing._id || editing.id);\n//         if(editingId){\n//           // update\n//           const res = await fetch(`${API_BASE}/api/books/${editingId}`, { method: 'PUT', headers, body: JSON.stringify(newBook) });\n//           if(!res.ok){\n//             const text = await res.text().catch(()=>res.statusText);\n//             throw new Error(text || 'Update failed');\n//           }\n//           // refresh list\n//           const remote = await fetch(`${API_BASE}/api/books`);\n//           const data = await remote.json();\n//           setBooks(data.map(b => ({ ...b, id: b._id || b.id })));\n//           setEditing(null);\n//           setForm(empty);\n//           showAlert('Saved', 'Book updated successfully.');\n//         } else {\n//           // create\n//           const res = await fetch(`${API_BASE}/api/books`, { method: 'POST', headers, body: JSON.stringify(newBook) });\n//           if(!res.ok){\n//             const text = await res.text().catch(()=>res.statusText);\n//             throw new Error(text || 'Create failed');\n//           }\n//           // refresh list\n//           const remote = await fetch(`${API_BASE}/api/books`);\n//           const data = await remote.json();\n//           setBooks(data.map(b => ({ ...b, id: b._id || b.id })));\n//           setForm(empty);\n//           showAlert('Saved', 'Book created successfully.');\n//         }\n//       }catch(err){\n//         // fallback to local behavior and surface an error\n//         showAlert('Save Failed', err.message || 'Failed to persist to server — saved locally as a fallback.');\n//         // If server says Unauthorized (expired/invalid JWT), force logout so user can re-login\n//         const msg = (err.message || '').toLowerCase();\n//         if(msg.includes('unauthorized') || msg.includes('jwt') || msg.includes('invalid token')){\n//           showAlert('Session Expired', 'Your admin session is invalid. Please log in again.');\n//           try{ logoutAdmin(navigate, true); }catch(e){}\n//         }\n//         if(editing){\n//           const idKey = editing.id || editing._id;\n//           setBooks(prev => prev.map(b => b.id === idKey ? {...newBook, id: idKey} : b));\n//           setEditing(null);\n//         }\n//         else {\n//           setBooks(prev => [{...newBook, id:`b${Date.now()}`}, ...prev]);\n//           setForm(empty);\n//         }\n//       }\n//     })();\n//   }\n\n//   function remove(id){\n//     showAlert('Confirm Deletion', 'Are you sure you want to delete this book? This action cannot be undone.', async () => {\n//       try{\n//   let token = null;\n//   try{ token = localStorage.getItem('pt_admin_token'); if(token) token = JSON.parse(token); }catch(e){ /* ignore */ }\n//   const headers = {};\n//   if(token) headers['Authorization'] = `Bearer ${token}`;\n//         const API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:4000';\n\n//         // try server delete\n//         const res = await fetch(`${API_BASE}/api/books/${id}`, { method: 'DELETE', headers });\n//         if(!res.ok){\n//           const text = await res.text().catch(()=>res.statusText);\n//           throw new Error(text || 'Delete failed');\n//         }\n//         const remote = await fetch(`${API_BASE}/api/books`);\n//         const data = await remote.json();\n//         setBooks(data.map(b => ({ ...b, id: b._id || b.id })));\n//         showAlert('Deleted', 'Book deleted successfully.');\n//       }catch(err){\n//         // fallback local\n//         showAlert('Delete Failed', err.message || 'Failed to delete on server — deleted locally.');\n//         const msg = (err.message || '').toLowerCase();\n//         if(msg.includes('unauthorized') || msg.includes('jwt') || msg.includes('invalid token')){\n//           showAlert('Session Expired', 'Your admin session is invalid. Please log in again.');\n//           try{ logoutAdmin(navigate, true); }catch(e){}\n//           return;\n//         }\n//         setBooks(prev => prev.filter(b=>b.id!==id));\n//       }\n//     });\n//   }\n\n//   const previewImage = form.images?.[0] || 'https://placehold.co/400x600?text=Cover';\n\n//   // Mark a book as featured (only one book should be featured at a time)\n//   async function toggleFeatured(id) {\n//     // Try server-side toggle first, fallback to local update\n//     try{\n//       await api.toggleFeatured(id);\n//       // refresh list from server\n//       const remote = await api.fetchBooks();\n//       if(Array.isArray(remote)) setBooks(remote.map(b => ({ ...b, id: b._id || b.id })));\n//       showAlert('Updated', 'Featured book updated.');\n//     }catch(err){\n//       // fallback: optimistic local update\n//       setBooks(prev => {\n//         const clicked = prev.find(b => b.id === id);\n//         const makeFeatured = !(clicked && clicked.featured);\n//         const updated = prev.map(b => ({ ...b, featured: makeFeatured && b.id === id }));\n//         return updated;\n//       });\n//       const clicked = books.find(b => b.id === id);\n//       if (clicked && clicked.featured) showAlert('Updated', `${clicked.title} is no longer featured.`);\n//       else if (clicked) showAlert('Updated', `${clicked.title} is now the featured book.`);\n//     }\n//   }\n\n//   // --- About Page / Author editor state ---\n//   const emptyAuthorForm = {\n//     name: '',\n//     tagline: '',\n//     bio: '',\n//     avatar: '',\n//     social: { instagram: '', goodreads: '', twitter: '' },\n//     stats: []\n//   };\n\n//   const [authorForm, setAuthorForm] = useState(author || emptyAuthorForm);\n\n//   useEffect(() => {\n//     setAuthorForm(author || emptyAuthorForm);\n//   }, [author]);\n\n//   function handleSocialChange(key, value) {\n//     setAuthorForm(prev => ({ ...prev, social: { ...prev.social, [key]: value } }));\n//   }\n\n//   function handleStatChange(index, field, value) {\n//     const newStats = [...(authorForm.stats || [])];\n//     newStats[index] = { ...newStats[index], [field]: value };\n//     setAuthorForm(prev => ({ ...prev, stats: newStats }));\n//   }\n\n//   function addStat() {\n//     setAuthorForm(prev => ({ ...prev, stats: [ ...(prev.stats || []), { label: '', value: '' } ] }));\n//   }\n\n//   function removeStat(index) {\n//     setAuthorForm(prev => ({ ...prev, stats: prev.stats.filter((_, i) => i !== index) }));\n//   }\n\n//   function saveAuthor() {\n//     if (!authorForm.name || !authorForm.bio) return showAlert('Validation Error', 'Author Name and Bio are required.');\n//     const cleanedStats = (authorForm.stats || []).map(s => ({ label: (s.label||'').trim(), value: (s.value||'').toString().trim() })).filter(s => s.label || s.value);\n//     const newAuthor = { ...authorForm, stats: cleanedStats };\n//     // Try saving to backend, fall back to local state\n//     (async () => {\n//       try{\n//         const saved = await api.saveAuthor(newAuthor);\n//         if(saved) setAuthor(saved);\n//         else setAuthor(newAuthor);\n//         showAlert('Saved', 'About page content updated successfully.');\n//       }catch(err){\n//         setAuthor(newAuthor);\n//         showAlert('Saved (local)', 'Saved locally but failed to persist to server.');\n//       }\n//     })();\n//   }\n\n//   // --- Blogs admin state and helpers ---\n//   const [blogs, setBlogs] = useState([]);\n//   const [blogEditing, setBlogEditing] = useState(null);\n//   const blogEmpty = { title: '', slug: '', image: '', excerpt: '', content: '', published: true, publishedAt: new Date().toISOString().slice(0,10), tags: [], externalLink: '', author: (author && author.name) || '' };\n//   const [blogForm, setBlogForm] = useState(blogEmpty);\n//   const [previewOpen, setPreviewOpen] = useState(false);\n//   const [blogUploading, setBlogUploading] = useState(false);\n\n//   function slugify(s=''){\n//     return s.toString().toLowerCase().trim()\n//       .replace(/[^a-z0-9\\s-]/g, '')\n//       .replace(/\\s+/g, '-')\n//       .replace(/-+/g, '-');\n//   }\n\n//   useEffect(()=>{\n//     (async ()=>{\n//       try{ const remote = await api.fetchBlogs(); if(Array.isArray(remote)) setBlogs(remote.map(b=>({ ...b, id: b._id || b.id }))); }catch(e){}\n//     })();\n//   }, []);\n\n//   useEffect(()=>{ if(blogEditing) setBlogForm({...blogEditing}); else setBlogForm(blogEmpty); }, [blogEditing]);\n\n//   async function saveBlog(){\n//     if(!blogForm.title) return showAlert('Validation Error', 'Title is required');\n//     try{\n//       // ensure slug, tags array, and publishedAt are set correctly\n//       const payload = { ...blogForm };\n//       payload.slug = payload.slug || slugify(payload.title || '');\n//       if(typeof payload.tags === 'string') payload.tags = payload.tags.split(',').map(t=>t.trim()).filter(Boolean);\n//       if(!payload.publishedAt) payload.publishedAt = new Date().toISOString();\n\n//       if(blogEditing && (blogEditing._id || blogEditing.id)){\n//         const id = blogEditing._id || blogEditing.id;\n//         await api.updateBlog(id, payload);\n//   const remote = await api.fetchBlogs(); if(Array.isArray(remote)) { setBlogs(remote.map(b=>({ ...b, id: b._id || b.id }))); window.dispatchEvent(new Event('blogs-updated')); }\n//         setBlogEditing(null); setBlogForm(blogEmpty);\n//         showAlert('Saved', 'Blog updated');\n//       } else {\n//         await api.createBlog(payload);\n//   const remote = await api.fetchBlogs(); if(Array.isArray(remote)) { setBlogs(remote.map(b=>({ ...b, id: b._id || b.id }))); window.dispatchEvent(new Event('blogs-updated')); }\n//         setBlogForm(blogEmpty);\n//         showAlert('Saved', 'Blog created');\n//       }\n//     }catch(err){\n//       showAlert('Save Failed', err.message || 'Failed to save blog');\n//     }\n//   }\n\n//   async function editBlog(blog){\n//     // fetch full blog from server in case list response is truncated\n//     try{\n//       const id = blog._id || blog.id;\n//       if(!id) return setBlogEditing(blog);\n//       const remote = await api.fetchBlog(id);\n//       // normalize tags to array for the form\n//       if(remote && remote.tags && !Array.isArray(remote.tags)){\n//         remote.tags = (remote.tags||'').toString().split(',').map(t=>t.trim()).filter(Boolean);\n//       }\n//       setBlogEditing(remote || blog);\n//     }catch(err){\n//       // fallback to using provided object\n//       setBlogEditing(blog);\n//       showAlert && showAlert('Load Failed', 'Could not load full blog details — using list data.');\n//     }\n//   }\n\n//   function removeBlogPrompt(blog){\n//     showAlert('Confirm Deletion', 'Delete this blog post? This cannot be undone.', async ()=>{\n//       try{\n//         const id = blog._id || blog.id;\n//         await api.deleteBlog(id);\n//         const remote = await api.fetchBlogs(); if(Array.isArray(remote)) setBlogs(remote.map(b=>({ ...b, id: b._id || b.id })));\n//         window.dispatchEvent(new Event('blogs-updated'));\n//         showAlert('Deleted', 'Blog deleted');\n//       }catch(err){\n//         showAlert('Delete Failed', err.message || 'Failed to delete blog');\n//       }\n//     });\n//   }\n\n//   // Handle image file input (convert to base64 data URL)\n//   function handleImageFile(e){\n//     const f = e.target.files && e.target.files[0];\n//     if(!f) return;\n\n//     // show an immediate local preview while uploading\n//     const localPreview = URL.createObjectURL(f);\n//     setBlogForm(prev => ({ ...prev, image: localPreview }));\n//     setBlogUploading(true);\n\n//     // upload to server endpoint /api/uploads\n//     (async () => {\n//       const API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:4000';\n//       const fd = new FormData();\n//       fd.append('file', f);\n//       try{\n//         // include Authorization header if available\n//         const headers = {};\n//         try{ let token = localStorage.getItem('pt_admin_token'); if(token) token = JSON.parse(token); if(token) headers['Authorization'] = `Bearer ${token}`; }catch(e){}\n//         const res = await fetch(`${API_BASE}/api/uploads`, { method: 'POST', headers, body: fd });\n//         if(!res.ok){\n//           const text = await res.text().catch(()=>res.statusText);\n//           throw new Error(text || 'Upload failed');\n//         }\n//         const data = await res.json();\n//         if(data && data.url){\n//           // replace preview with server-hosted URL\n//           setBlogForm(prev => ({ ...prev, image: data.url }));\n//         } else {\n//           throw new Error('Invalid upload response');\n//         }\n//       }catch(err){\n//         // If upload fails, fall back to a base64 preview and notify the admin\n//         const reader = new FileReader();\n//         reader.onload = () => {\n//           setBlogForm(prev => ({ ...prev, image: reader.result }));\n//         };\n//         reader.readAsDataURL(f);\n//         try{ showAlert('Upload Failed', err.message || 'Image upload failed; using local preview.'); }catch(e){}\n//       } finally {\n//         setBlogUploading(false);\n//         // revoke the temporary object URL after a short delay to ensure the image element has loaded it\n//         setTimeout(()=>{ try{ URL.revokeObjectURL(localPreview); }catch(e){} }, 3000);\n//       }\n//     })();\n//   }\n\n//   // --- Simple URL validation for avatar and social links ---\n//   function isValidUrl(u){\n//     if(!u) return true; // allow empty\n//     try { const url = new URL(u); return url.protocol === 'http:' || url.protocol === 'https:'; } catch { return false; }\n//   }\n\n//   const avatarValid = isValidUrl(authorForm.avatar);\n//   const instagramValid = isValidUrl(authorForm.social?.instagram);\n//   const goodreadsValid = isValidUrl(authorForm.social?.goodreads);\n//   const twitterValid = isValidUrl(authorForm.social?.twitter);\n\n//   function currency(n){ return `₹${Number(n).toLocaleString('en-IN')}` }\n\n//   return (\n//     <motion.main initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className=\"max-w-7xl mx-auto px-6 py-12\">\n//       <div className=\"flex items-center justify-between mb-6\">\n//         <h2 className=\"font-serif text-3xl text-amber-600 dark:text-amber-500\">Admin Dashboard</h2>\n//         <div className=\"flex flex-wrap gap-2\">\n//           <button onClick={() => { setActiveTab('books'); }} className={`px-4 py-2 rounded ${activeTab==='books' ? 'bg-amber-600 text-white' : 'bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-700'}`}>Books</button>\n//           <button onClick={() => { setActiveTab('about'); }} className={`px-4 py-2 rounded ${activeTab==='about' ? 'bg-emerald-600 text-white' : 'bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-700'}`}>About Editor</button>\n//           <button onClick={() => { setActiveTab('blogs'); }} className={`px-4 py-2 rounded ${activeTab==='blogs' ? 'bg-pink-600 text-white' : 'bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-700'}`}>Blogs</button>\n//           <button onClick={() => { setActiveTab('orders'); loadOrderCounts(); }} className={`px-4 py-2 rounded ${activeTab==='orders' ? 'bg-indigo-600 text-white' : 'bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-700'}`}>\n//             Orders\n//             {(orderCount > 0 || queuedCount > 0) && (\n//               <span className=\"ml-2 inline-flex items-center gap-1\">\n//                 {orderCount > 0 && <span className=\"px-2 py-0.5 bg-rose-500 text-white rounded-full text-xs\">{orderCount}</span>}\n//                 {queuedCount > 0 && <span className=\"px-2 py-0.5 bg-amber-500 text-white rounded-full text-xs\">Q:{queuedCount}</span>}\n//               </span>\n//             )}\n//           </button>\n//           <button onClick={() => { setActiveTab('books'); setEditing(null); setForm && setForm(empty); setTimeout(()=>{ if(asideRef.current) asideRef.current.scrollIntoView({behavior:'smooth', block:'center'}); }, 100); }} className=\"px-4 py-2 rounded bg-slate-900 text-white\">Add Book</button>\n//         </div>\n//       </div>\n\n//       {activeTab === 'books' && (\n//       <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n//         <div className=\"lg:col-span-2\">\n//           <h3 className=\"text-xl mb-4 font-semibold\">Book List ({books.length})</h3>\n//           <div className=\"grid gap-3\">\n//             {books.map(b=> (\n//               <div key={b.id} className=\"p-3 border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-xl flex flex-col sm:flex-row items-start sm:items-center justify-between shadow-sm\">\n//                 <div className=\"flex items-start sm:items-center gap-3 w-full\">\n//                   <img src={b.images?.[0]} alt={b.title} className=\"w-12 h-18 sm:w-16 sm:h-24 object-cover rounded-md shadow-md flex-shrink-0\" onError={(e) => {e.target.onerror = null; e.target.src='https://placehold.co/400x600?text=Img'}}/>\n//                   <div className=\"flex-1 min-w-0\">\n//                     <div className=\"font-semibold text-base sm:text-lg truncate\">{b.title}</div>\n//                     <div className=\"text-sm text-slate-500 truncate\">{b.genre} • {currency(b.price)}</div>\n//                   </div>\n//                 </div>\n//                 <div className=\"flex flex-col sm:flex-row gap-2 mt-3 sm:mt-0\">\n//                   {/* Featured toggle */}\n//                   {b.featured ? (\n//                     <button onClick={() => toggleFeatured(b.id)} title=\"Unfeature\" className=\"px-3 py-1 rounded-lg bg-amber-500 text-white text-sm flex items-center gap-2\">\n//                       <span>★</span>\n//                       <span className=\"hidden sm:inline\">Featured</span>\n//                     </button>\n//                   ) : (\n//                     <button onClick={() => toggleFeatured(b.id)} title=\"Mark as featured\" className=\"px-3 py-1 rounded-lg border border-amber-500 text-amber-600 hover:bg-amber-50 transition text-sm\">Mark Featured</button>\n//                   )}\n//                   <button onClick={()=>setEditing(b)} className=\"px-3 py-1 border border-amber-500 text-amber-600 dark:text-amber-500 rounded-lg hover:bg-amber-50 transition text-sm\">Edit</button>\n//                   <button onClick={()=>remove(b.id)} className=\"px-3 py-1 border border-rose-500 text-rose-500 rounded-lg hover:bg-rose-50 transition text-sm\">Delete</button>\n//                 </div>\n//               </div>\n//             ))}\n//           </div>\n//         </div>\n\n//   <aside ref={asideRef} className=\"p-6 border border-slate-300 dark:border-slate-700 rounded-xl bg-white dark:bg-slate-800 shadow-lg h-fit md:sticky md:top-20\">\n//           <h3 className=\"text-xl font-semibold mb-4\">{editing? 'Edit Book' : 'Add New Book'}</h3>\n//           <div className=\"space-y-3\">\n//             <input value={form.title} onChange={e=>setForm({...form, title:e.target.value})} placeholder=\"Title\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" required />\n//             <input value={form.subtitle} onChange={e=>setForm({...form, subtitle:e.target.value})} placeholder=\"Subtitle\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n//             <input type=\"number\" value={form.price} onChange={e=>setForm({...form, price:e.target.value})} placeholder=\"Price (₹)\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" required />\n\n//             <input \n//                 value={form.genre} \n//                 onChange={e=>setForm({...form, genre:e.target.value})} \n//                 placeholder=\"Genre (e.g., Fiction, Poetry, Thriller)\" \n//                 className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" \n//                 list=\"genre-suggestions\"\n//                 required\n//             />\n//             <datalist id=\"genre-suggestions\">\n//                 {existingGenres.map(genre => <option key={genre} value={genre} />)}\n//             </datalist>\n\n//             <input type=\"number\" value={form.pages} onChange={e=>setForm({...form, pages:e.target.value})} placeholder=\"Pages\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n//             <input value={form.isbn} onChange={e=>setForm({...form, isbn:e.target.value})} placeholder=\"ISBN\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n//             <input type=\"date\" value={form.pubDate} onChange={e=>setForm({...form, pubDate:e.target.value})} placeholder=\"Publication Date\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n//             <textarea value={form.description} onChange={e=>setForm({...form, description:e.target.value})} placeholder=\"Description\" className=\"p-3 border rounded-lg w-full h-32 dark:bg-slate-900\" />\n\n//             <h4 className=\"pt-3 font-semibold text-sm text-slate-500 dark:text-slate-400\">Book Images (First is Cover)</h4>\n//             <div className=\"space-y-3\">\n//               {form.images.map((image, index) => (\n//                 <div key={index} className=\"flex gap-2\">\n//                   <input\n//                     value={image}\n//                     onChange={e => handleImageChange(index, e.target.value)}\n//                     placeholder={index === 0 ? \"Primary Cover URL (Required)\" : `Image URL ${index + 1}`}\n//                     className=\"p-3 border rounded-lg w-full dark:bg-slate-900\"\n//                     required={index === 0}\n//                   />\n//                   <button\n//                     onClick={() => removeImage(index)}\n//                     className={`px-3 py-1 rounded-lg transition text-white ${index === 0 ? 'bg-slate-400 cursor-not-allowed' : 'bg-rose-500 hover:bg-rose-700'}`}\n//                     disabled={index === 0}\n//                     type=\"button\"\n//                     title={index === 0 ? \"Cannot remove primary cover\" : \"Remove Image\"}\n//                   >\n//                     ✕\n//                   </button>\n//                 </div>\n//               ))}\n//               <button onClick={addImage} className=\"inline-flex items-center gap-2 px-3 py-2 bg-slate-900 hover:bg-slate-700 text-white rounded-lg transition\" type=\"button\">\n//                 <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\"/></svg>\n//                 Add Image\n//               </button>\n//             </div>\n//           </div>\n//           <div className=\"flex flex-col sm:flex-row gap-3 mt-4\">\n//             <button onClick={save} className=\"w-full sm:w-auto px-5 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-semibold transition\">Save</button>\n//             <button onClick={()=>{ setEditing(null); setForm(empty); }} className=\"w-full sm:w-auto px-5 py-2 border border-slate-400 dark:border-slate-600 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 transition\">\n//               {editing ? 'Cancel Edit' : 'Clear Form'}\n//             </button>\n//           </div>\n\n//           {form.title && (\n//             <div className=\"mt-6 pt-4 border-t border-dashed border-slate-300 dark:border-slate-700\">\n//               <h5 className=\"font-semibold text-lg mb-3\">Live Card Preview</h5>\n//               <div className=\"p-3 border border-slate-300 dark:border-slate-700 rounded-xl flex gap-4 items-center\">\n//                 <img src={previewImage} alt=\"preview\" className=\"w-20 h-28 object-cover rounded-md shadow\" onError={(e) => { e.target.onerror = null; e.target.src = 'https://placehold.co/400x600?text=Cover Not Found'; }} />\n//                 <div>\n//                   <div className=\"font-bold text-lg\">{form.title}</div>\n//                   <div className=\"text-sm text-slate-500\">{form.genre} • {form.pages || '??'} pages</div>\n\n//                 </div>\n//               </div>\n//             </div>\n//           )}\n\n//           <div className=\"mt-6 pt-4 border-t border-dashed border-slate-300 dark:border-slate-700\">\n//              <button onClick={() => logoutAdmin(navigate)} className=\"w-full px-5 py-2 bg-rose-600 hover:bg-rose-700 text-white rounded-lg font-semibold transition shadow-md\">Logout Admin</button>\n//           </div>\n//         </aside>\n//         </div>\n//         )}\n\n//         {activeTab === 'orders' && (\n//           <div className=\"mt-4\">\n//             <OrdersAdmin />\n//           </div>\n//         )}\n\n//       {activeTab === 'blogs' && (\n//         <div className=\"mt-8 grid grid-cols-1 lg:grid-cols-10 gap-8 items-start\">\n//           <div className=\"lg:col-span-4\">\n//             <h3 className=\"text-xl mb-4 font-semibold\">Blog Posts ({blogs.length})</h3>\n//             <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n//               {blogs.map(b => (\n//                 <div key={b.id} className=\"p-4 border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-xl shadow-sm flex flex-col sm:flex-row gap-4 items-stretch min-h-[12rem] box-border\">\n//                   <div className=\"w-full sm:w-1/2 flex-shrink-0 flex items-center\">\n//                     <img src={b.image || 'https://placehold.co/320x200?text=Blog'} alt={b.title} className=\"w-full h-44 sm:h-40 md:h-48 object-cover rounded-md shadow-sm\" onError={(e)=>{e.target.onerror=null; e.target.src='https://placehold.co/320x200?text=Img'}} />\n//                   </div>\n//                   <div className=\"flex-1 flex flex-col justify-between min-w-0\">\n//                     <div>\n//                       <div className=\"font-semibold text-lg leading-tight truncate break-words\">{b.title}</div>\n//                       <div className=\"text-sm text-slate-500 mt-2\" style={{ display: '-webkit-box', WebkitLineClamp: 3, WebkitBoxOrient: 'vertical', overflow: 'hidden', wordBreak: 'break-word' }}>{b.excerpt || ''}</div>\n//                     </div>\n//                     <div className=\"mt-4 flex items-center justify-between gap-3\">\n//                       <div className={`text-sm px-2 py-1 rounded ${b.published ? 'bg-emerald-600 text-white' : 'bg-slate-200 text-slate-700'}`}>{b.published ? 'Published' : 'Draft'}</div>\n//                       <div className=\"flex items-center gap-2 flex-shrink-0\">\n//                         <button onClick={() => editBlog(b)} className=\"px-3 py-1 border border-amber-500 text-amber-600 rounded-lg text-sm\">Edit</button>\n//                         <button onClick={() => removeBlogPrompt(b)} className=\"px-3 py-1 border border-rose-500 text-rose-500 rounded-lg text-sm\">Delete</button>\n//                       </div>\n//                     </div>\n//                   </div>\n//                 </div>\n//               ))}\n//             </div>\n//           </div>\n\n//           <aside className=\"p-6 border border-slate-300 dark:border-slate-700 rounded-xl bg-white dark:bg-slate-800 shadow-lg h-fit lg:col-span-6 lg:sticky lg:top-20 relative z-10 max-h-[calc(100vh-6rem)] overflow-auto\">\n//             <h3 className=\"text-xl font-semibold mb-4\">{blogEditing ? 'Edit Blog' : 'Add Blog'}</h3>\n//             <div className=\"space-y-3\">\n//               <input value={blogForm.title} onChange={e=>setBlogForm({...blogForm, title:e.target.value, slug: slugify(e.target.value)})} placeholder=\"Title\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n\n//               <div className=\"grid grid-cols-1 gap-2\">\n//                 <div className=\"flex items-center gap-3\">\n//                   <div className=\"w-24 h-16 bg-slate-100 rounded overflow-hidden border\">\n//                     {blogForm.image ? <img src={blogForm.image} alt=\"featured\" className=\"w-full h-full object-cover\" /> : <div className=\"w-full h-full flex items-center justify-center text-xs text-slate-500\">No image</div>}\n//                   </div>\n//                   <div className=\"flex-1\">\n//                     <div className=\"flex items-center gap-2\">\n//                       <input type=\"file\" accept=\"image/*\" onChange={handleImageFile} className=\"text-sm text-slate-500\" />\n//                       {blogUploading && (\n//                         <div className=\"text-xs text-amber-600 flex items-center gap-2\">\n//                           <svg className=\"w-4 h-4 animate-spin\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n//                             <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" strokeOpacity=\"0.2\" />\n//                             <path d=\"M22 12a10 10 0 0 1-10 10\" stroke=\"currentColor\" strokeWidth=\"4\" strokeLinecap=\"round\" />\n//                           </svg>\n//                           <span>Uploading...</span>\n//                         </div>\n//                       )}\n//                     </div>\n//                     <input value={blogForm.image} onChange={e=>setBlogForm({...blogForm, image:e.target.value})} placeholder=\"Or image URL\" className=\"mt-2 p-2 border rounded w-full dark:bg-slate-900 text-sm\" />\n//                   </div>\n//                 </div>\n//               </div>\n\n//               <textarea value={blogForm.excerpt} onChange={e=>setBlogForm({...blogForm, excerpt:e.target.value})} placeholder=\"Short description / excerpt\" className=\"p-3 border rounded-lg w-full h-20 dark:bg-slate-900\" />\n\n//               <input value={(Array.isArray(blogForm.tags) ? blogForm.tags.join(', ') : blogForm.tags||'')} onChange={e=>setBlogForm({...blogForm, tags: e.target.value})} placeholder=\"Tags (comma-separated)\" className=\"p-2 border rounded w-full dark:bg-slate-900 text-sm\" />\n\n//               <input value={blogForm.externalLink||''} onChange={e=>setBlogForm({...blogForm, externalLink:e.target.value})} placeholder=\"External / embed link (optional)\" className=\"p-2 border rounded w-full dark:bg-slate-900 text-sm\" />\n\n//               <div className=\"flex gap-2\">\n//                 <label className=\"text-sm\">Publish Date</label>\n//                 <input type=\"date\" value={blogForm.publishedAt ? blogForm.publishedAt.slice(0,10) : new Date().toISOString().slice(0,10)} onChange={e=>setBlogForm({...blogForm, publishedAt: e.target.value})} className=\"p-2 border rounded ml-2\" />\n//               </div>\n\n//               <div>\n//                 <div className=\"text-sm font-medium mb-2\">Content</div>\n//                 <ReactQuill theme=\"snow\" value={blogForm.content || ''} onChange={val=>setBlogForm({...blogForm, content: val})} modules={{ toolbar: [[{ 'header': [1,2,3,false] }], ['bold','italic','underline','strike'], ['blockquote','code-block'], [{ 'list': 'ordered'}, { 'list': 'bullet' }], ['link','image'], ['clean'] ] }} formats={[ 'header','bold','italic','underline','strike','blockquote','code-block','list','bullet','link','image' ]} />\n//               </div>\n\n//               <label className=\"flex items-center gap-2 text-sm\"><input type=\"checkbox\" checked={!!blogForm.published} onChange={e=>setBlogForm({...blogForm, published: e.target.checked})} /> Published</label>\n//             </div>\n//             <div className=\"flex gap-3 mt-4\">\n//               <button onClick={saveBlog} className=\"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded\">{blogEditing ? 'Update' : 'Save'}</button>\n//               <button onClick={()=>setPreviewOpen(true)} className=\"px-4 py-2 border rounded\">Preview</button>\n//               {blogEditing && <button onClick={()=>removeBlogPrompt(blogEditing)} className=\"px-4 py-2 border border-rose-500 text-rose-600 rounded\">Delete</button>}\n//               <button onClick={()=>{ setBlogEditing(null); setBlogForm(blogEmpty); }} className=\"px-4 py-2 border rounded\">Cancel</button>\n//             </div>\n\n//             {previewOpen && (\n//               <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center\">\n//                 <div className=\"w-full max-w-3xl bg-white dark:bg-slate-800 p-6 rounded shadow-lg overflow-auto max-h-[90vh]\">\n//                   <div className=\"flex justify-between items-center mb-4\">\n//                     <h3 className=\"text-xl font-semibold\">Preview: {blogForm.title}</h3>\n//                     <button onClick={()=>setPreviewOpen(false)} className=\"px-3 py-1 border rounded\">Close</button>\n//                   </div>\n//                   {blogForm.image && <img src={blogForm.image} alt=\"preview\" className=\"w-full h-64 object-cover rounded mb-4\" />}\n//                   <div className=\"prose dark:prose-invert max-w-none\" dangerouslySetInnerHTML={{ __html: blogForm.content || `<p>${blogForm.excerpt||''}</p>` }} />\n//                 </div>\n//               </div>\n//             )}\n//           </aside>\n//         </div>\n//       )}\n\n//   {/* About Page Editor (Admin) */}\n//   {activeTab === 'about' && (\n//     <div className=\"mt-8 p-6 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700\">\n//       <div className=\"flex items-start justify-between mb-4\">\n//         <h3 className=\"font-serif text-2xl\">About Page Editor</h3>\n//         <div className=\"flex items-center gap-2\">\n//           <button onClick={saveAuthor} disabled={!avatarValid || !instagramValid || !goodreadsValid || !twitterValid || !authorForm.name || !authorForm.bio} className={`px-4 py-2 rounded ${(!avatarValid || !instagramValid || !goodreadsValid || !twitterValid || !authorForm.name || !authorForm.bio) ? 'bg-slate-400 cursor-not-allowed' : 'bg-emerald-600 hover:bg-emerald-700'} text-white`}>Save</button>\n//           <button onClick={()=>setAuthorForm(author || emptyAuthorForm)} className=\"px-4 py-2 rounded border\">Reset</button>\n//         </div>\n//       </div>\n\n//       <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n//         {/* Form column */}\n//         <div className=\"md:col-span-2 space-y-4\">\n//           <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n//             <div>\n//               <label className=\"text-sm font-medium mb-1 block\">Name</label>\n//               <input value={authorForm.name} onChange={e=>setAuthorForm({...authorForm, name:e.target.value})} placeholder=\"Author Name\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n\n//               <label className=\"text-sm font-medium mb-1 block mt-3\">Tagline</label>\n//               <input value={authorForm.tagline} onChange={e=>setAuthorForm({...authorForm, tagline:e.target.value})} placeholder=\"Short tagline\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n\n//               <label className=\"text-sm font-medium mb-1 block mt-3\">Avatar URL</label>\n//               <input value={authorForm.avatar} onChange={e=>setAuthorForm({...authorForm, avatar:e.target.value})} placeholder=\"https://...\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n//               {!avatarValid && <div className=\"text-rose-500 text-xs mt-1\">Avatar must be a valid http(s) URL</div>}\n//             </div>\n\n//             <div>\n//               <label className=\"text-sm font-medium mb-1 block\">Short Bio</label>\n//               <textarea value={authorForm.bio} onChange={e=>setAuthorForm({...authorForm, bio:e.target.value})} placeholder=\"A short author bio\" className=\"p-3 border rounded-lg w-full h-36 dark:bg-slate-900\" />\n//             </div>\n//           </div>\n\n//           <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n//             <div>\n//               <div className=\"text-sm font-medium mb-2\">Social Links</div>\n//               <input value={authorForm.social?.instagram || ''} onChange={e=>handleSocialChange('instagram', e.target.value)} placeholder=\"Instagram URL\" className=\"p-2 border rounded-lg w-full dark:bg-slate-900 mb-2\" />\n//               {!instagramValid && <div className=\"text-rose-500 text-xs mb-2\">Must be a valid http(s) URL</div>}\n\n//               <input value={authorForm.social?.goodreads || ''} onChange={e=>handleSocialChange('goodreads', e.target.value)} placeholder=\"Goodreads URL\" className=\"p-2 border rounded-lg w-full dark:bg-slate-900 mb-2\" />\n//               {!goodreadsValid && <div className=\"text-rose-500 text-xs mb-2\">Must be a valid http(s) URL</div>}\n\n//               <input value={authorForm.social?.twitter || ''} onChange={e=>handleSocialChange('twitter', e.target.value)} placeholder=\"Twitter URL\" className=\"p-2 border rounded-lg w-full dark:bg-slate-900\" />\n//               {!twitterValid && <div className=\"text-rose-500 text-xs mt-1\">Must be a valid http(s) URL</div>}\n//             </div>\n\n//             <div>\n//               <div className=\"flex items-center justify-between mb-2\">\n//                 <div className=\"text-sm font-medium\">Milestones / Stats</div>\n//                 <button onClick={addStat} type=\"button\" className=\"px-2 py-1 bg-slate-900 text-white rounded text-sm\">Add Stat</button>\n//               </div>\n//               <div className=\"space-y-2\">\n//                 {(authorForm.stats || []).map((s, idx) => (\n//                   <div key={idx} className=\"flex gap-2\">\n//                     <input value={s.label} onChange={e=>handleStatChange(idx, 'label', e.target.value)} placeholder=\"Label (e.g., Books Published)\" className=\"p-2 border rounded-lg w-1/2 dark:bg-slate-900\" />\n//                     <input value={s.value} onChange={e=>handleStatChange(idx, 'value', e.target.value)} placeholder=\"Value (e.g., 7)\" className=\"p-2 border rounded-lg w-1/3 dark:bg-slate-900\" />\n//                     <button onClick={()=>removeStat(idx)} type=\"button\" className=\"px-2 py-1 bg-rose-500 text-white rounded\">✕</button>\n//                   </div>\n//                 ))}\n//                 {!(authorForm.stats || []).length && <div className=\"text-sm text-slate-500\">No stats yet — click Add Stat to create one.</div>}\n//               </div>\n//             </div>\n//           </div>\n//         </div>\n\n//         {/* Preview column */}\n//         <div className=\"p-4 bg-slate-50 dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-700\">\n//           <div className=\"flex flex-col items-center text-center\">\n//             <img src={authorForm.avatar || 'https://placehold.co/160x160?text=Avatar'} alt=\"preview avatar\" className=\"w-28 h-28 rounded-full object-cover mb-3\" onError={(e)=>{e.target.onerror=null; e.target.src='https://placehold.co/160x160?text=Avatar'}} />\n//             <div className=\"font-serif text-xl font-semibold\">{authorForm.name || 'Author Name'}</div>\n//             <div className=\"text-sm text-slate-500\">{authorForm.tagline || 'Tagline goes here'}</div>\n//             <p className=\"mt-3 text-sm text-slate-600 dark:text-slate-400\">{authorForm.bio || 'Short bio preview will appear here as you type.'}</p>\n//             <div className=\"mt-3 flex gap-2\">\n//               {authorForm.social?.instagram && <a href={authorForm.social.instagram} target=\"_blank\" rel=\"noreferrer\" className={`text-xs px-2 py-1 rounded ${instagramValid? 'bg-amber-500 text-white': 'bg-rose-200 text-rose-700'}`}>Instagram</a>}\n//               {authorForm.social?.goodreads && <a href={authorForm.social.goodreads} target=\"_blank\" rel=\"noreferrer\" className={`text-xs px-2 py-1 rounded ${goodreadsValid? 'bg-amber-500 text-white': 'bg-rose-200 text-rose-700'}`}>Goodreads</a>}\n//               {authorForm.social?.twitter && <a href={authorForm.social.twitter} target=\"_blank\" rel=\"noreferrer\" className={`text-xs px-2 py-1 rounded ${twitterValid? 'bg-amber-500 text-white': 'bg-rose-200 text-rose-700'}`}>Twitter</a>}\n//             </div>\n//             {authorForm.stats?.length > 0 && (\n//               <div className=\"mt-4 grid grid-cols-2 gap-2 w-full\">\n//                 {authorForm.stats.map((s, i) => (\n//                   <div key={i} className=\"p-2 bg-white dark:bg-slate-800 rounded text-center border\">\n//                     <div className=\"text-2xl font-bold text-amber-500\">{s.value || '—'}</div>\n//                     <div className=\"text-xs text-slate-500\">{s.label || 'Stat'}</div>\n//                   </div>\n//                 ))}\n//               </div>\n//             )}\n//           </div>\n//         </div>\n//       </div>\n//     </div>\n//   )}\n\n//     </motion.main>\n//   );\n// }\nimport React, { useState, useEffect } from \"react\";\nimport api from \"../lib/api\";\nimport { useNavigate } from \"react-router-dom\";\nimport { motion } from \"framer-motion\";\nimport OrdersAdmin from \"./OrdersAdmin\";\nimport ReactMarkdown from \"react-markdown\";\nimport remarkGfm from \"remark-gfm\";\nimport ReactQuill from \"react-quill\";\nimport \"react-quill/dist/quill.snow.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Admin({\n  books,\n  setBooks,\n  showAlert,\n  logoutAdmin,\n  author,\n  setAuthor\n}) {\n  _s();\n  const navigate = useNavigate();\n  const [orderCount, setOrderCount] = React.useState(0);\n  const [queuedCount, setQueuedCount] = React.useState(0);\n  const [editing, setEditing] = useState(null);\n  const [activeTab, setActiveTab] = useState(\"books\");\n  const asideRef = /*#__PURE__*/React.createRef();\n\n  // same DB logic preserved...\n\n  return /*#__PURE__*/_jsxDEV(motion.main, {\n    initial: {\n      opacity: 0\n    },\n    animate: {\n      opacity: 1\n    },\n    className: \"max-w-7xl mx-auto px-4 sm:px-6 py-10 text-slate-800 dark:text-slate-100\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sticky top-0 z-20 bg-gradient-to-r from-amber-50 to-emerald-50 dark:from-slate-800 dark:to-slate-900 p-4 rounded-xl shadow-md mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl sm:text-3xl font-bold font-serif text-amber-600 dark:text-amber-400 tracking-wide\",\n        children: \"Admin Dashboard\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 763,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-wrap justify-start sm:justify-end gap-2\",\n        children: [[{\n          key: \"books\",\n          label: \"Books\",\n          color: \"amber\"\n        }, {\n          key: \"about\",\n          label: \"About Editor\",\n          color: \"emerald\"\n        }, {\n          key: \"blogs\",\n          label: \"Blogs\",\n          color: \"pink\"\n        }, {\n          key: \"orders\",\n          label: \"Orders\",\n          color: \"indigo\"\n        }].map(tab => /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            setActiveTab(tab.key);\n            if (tab.key === \"orders\") loadOrderCounts();\n          },\n          className: `px-4 py-2 rounded-lg font-medium shadow-sm transition-all duration-200 ${activeTab === tab.key ? `bg-${tab.color}-600 text-white` : \"bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-700 hover:shadow\"}`,\n          children: [tab.label, tab.key === \"orders\" && (orderCount > 0 || queuedCount > 0) && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ml-2 inline-flex gap-1\",\n            children: [orderCount > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"px-2 py-0.5 bg-rose-500 text-white rounded-full text-xs\",\n              children: orderCount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 790,\n              columnNumber: 21\n            }, this), queuedCount > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"px-2 py-0.5 bg-amber-500 text-white rounded-full text-xs\",\n              children: [\"Q:\", queuedCount]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 795,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 788,\n            columnNumber: 17\n          }, this)]\n        }, tab.key, true, {\n          fileName: _jsxFileName,\n          lineNumber: 774,\n          columnNumber: 13\n        }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            setActiveTab(\"books\");\n            setEditing(null);\n            setForm(empty);\n            setTimeout(() => {\n              if (asideRef.current) asideRef.current.scrollIntoView({\n                behavior: \"smooth\"\n              });\n            }, 100);\n          },\n          className: \"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-700 shadow font-semibold transition\",\n          children: \"+ Add Book\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 804,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 767,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 762,\n      columnNumber: 7\n    }, this), activeTab === \"books\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 lg:grid-cols-3 gap-10\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lg:col-span-2 space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-xl font-semibold border-b pb-2\",\n          children: [\"Books (\", books.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 825,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid gap-4\",\n          children: books.map(b => {\n            var _b$images;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-xl shadow-sm hover:shadow-md transition-all duration-300\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-4 w-full\",\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: (_b$images = b.images) === null || _b$images === void 0 ? void 0 : _b$images[0],\n                  alt: b.title,\n                  className: \"w-14 h-20 object-cover rounded-lg shadow\",\n                  onError: e => {\n                    e.target.src = \"https://placehold.co/400x600?text=Cover\";\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 835,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex-1 min-w-0\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"font-semibold text-lg truncate\",\n                    children: b.title\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 845,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-slate-500 truncate\",\n                    children: [b.genre, \" \\u2022 \\u20B9\", Number(b.price).toLocaleString(\"en-IN\")]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 848,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 844,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 834,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex gap-2 mt-3 sm:mt-0\",\n                children: [b.featured ? /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => toggleFeatured(b.id),\n                  className: \"px-3 py-1 rounded-lg bg-amber-500 text-white text-sm\",\n                  children: \"\\u2605 Featured\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 856,\n                  columnNumber: 23\n                }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => toggleFeatured(b.id),\n                  className: \"px-3 py-1 rounded-lg border border-amber-500 text-amber-600 hover:bg-amber-50 text-sm\",\n                  children: \"Mark Featured\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 863,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => setEditing(b),\n                  className: \"px-3 py-1 border border-emerald-500 text-emerald-600 hover:bg-emerald-50 rounded-lg text-sm\",\n                  children: \"Edit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 870,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => remove(b.id),\n                  className: \"px-3 py-1 border border-rose-500 text-rose-500 hover:bg-rose-50 rounded-lg text-sm\",\n                  children: \"Delete\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 876,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 854,\n                columnNumber: 19\n              }, this)]\n            }, b.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 830,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 828,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 824,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n        ref: asideRef,\n        className: \"p-6 border border-slate-300 dark:border-slate-700 rounded-xl bg-gradient-to-b from-white to-slate-50 dark:from-slate-800 dark:to-slate-900 shadow-xl h-fit sticky top-24\",\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold mb-4 text-amber-600 dark:text-amber-400\",\n          children: editing ? \"Edit Book\" : \"Add New Book\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 893,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 889,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 823,\n      columnNumber: 9\n    }, this), activeTab === \"orders\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-8\",\n      children: /*#__PURE__*/_jsxDEV(OrdersAdmin, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 905,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 904,\n      columnNumber: 9\n    }, this), activeTab === \"blogs\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-8\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 910,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 756,\n    columnNumber: 5\n  }, this);\n}\n_s(Admin, \"YEXNwcu94TT5r+GJRV1HmTEhCuY=\", false, function () {\n  return [useNavigate];\n});\n_c = Admin;\nvar _c;\n$RefreshReg$(_c, \"Admin\");","map":{"version":3,"names":["React","useState","useEffect","api","useNavigate","motion","OrdersAdmin","ReactMarkdown","remarkGfm","ReactQuill","jsxDEV","_jsxDEV","Admin","books","setBooks","showAlert","logoutAdmin","author","setAuthor","_s","navigate","orderCount","setOrderCount","queuedCount","setQueuedCount","editing","setEditing","activeTab","setActiveTab","asideRef","createRef","main","initial","opacity","animate","className","children","fileName","_jsxFileName","lineNumber","columnNumber","key","label","color","map","tab","onClick","loadOrderCounts","setForm","empty","setTimeout","current","scrollIntoView","behavior","length","b","_b$images","src","images","alt","title","onError","e","target","genre","Number","price","toLocaleString","featured","toggleFeatured","id","remove","ref","_c","$RefreshReg$"],"sources":["/Users/viveksingh/Desktop/book-frontend/src/components/Admin.js"],"sourcesContent":["// import React, { useState, useEffect } from 'react';\n// import api from '../lib/api';\n// import { useNavigate } from 'react-router-dom';\n// import { motion } from 'framer-motion';\n// import OrdersAdmin from './OrdersAdmin';\n// import ReactMarkdown from 'react-markdown';\n// import remarkGfm from 'remark-gfm';\n// import ReactQuill from 'react-quill';\n// import 'react-quill/dist/quill.snow.css';\n\n// export default function Admin({ books, setBooks, showAlert, logoutAdmin, author, setAuthor }){\n//   const navigate = useNavigate();\n//   const [orderCount, setOrderCount] = React.useState(0);\n//   const [queuedCount, setQueuedCount] = React.useState(0);\n//   const [editing, setEditing] = useState(null);\n//   const [activeTab, setActiveTab] = useState('books'); // 'books' | 'about'\n//   const asideRef = React.createRef();\n\n//   const existingGenres = [...new Set(books.map(b => b.genre).filter(g => g))].sort();\n\n//   const empty = {\n//     title:'', subtitle:'', price:'',\n//     images: ['https://placehold.co/800x1200?text=New+Book+Cover'],\n//     description:'', genre:'', pages:0, isbn:'', pubDate: new Date().toISOString().slice(0, 10)\n//   };\n//   const [form, setForm] = useState(empty);\n\n//   useEffect(()=>{\n//     if(editing) {\n//       setForm({...editing, images: editing.images || [empty.images[0]]});\n//     } else {\n//       setForm(empty);\n//     }\n//   }, [editing]);\n\n//   // Load order counts for badge\n//   async function loadOrderCounts(){\n//     try{\n//       const orders = await api.fetchOrders();\n//       setOrderCount(Array.isArray(orders) ? orders.length : 0);\n//     }catch(e){ setOrderCount(0); }\n//     try{\n//       const q = await api.fetchOrderQueue();\n//       setQueuedCount(Array.isArray(q) ? q.length : 0);\n//     }catch(e){ setQueuedCount(0); }\n//   }\n\n//   React.useEffect(()=>{ loadOrderCounts(); }, []);\n\n//   function handleImageChange(index, value) {\n//     const newImages = [...form.images];\n//     newImages[index] = value;\n//     setForm({...form, images: newImages });\n//   }\n\n//   function addImage() {\n//     setForm({...form, images: [...form.images, ''] });\n//   }\n\n//   function removeImage(index) {\n//     if (form.images.length === 1) {\n//       return showAlert('Error', 'A book must have at least one image (the primary cover).');\n//     }\n//     const newImages = form.images.filter((_, i) => i !== index);\n//     setForm({...form, images: newImages });\n//   }\n\n//   function save(){\n//     const cleanedImages = form.images.filter(img => img && img.trim());\n\n//     if(!form.title || !form.price || !form.genre) return showAlert('Validation Error', 'Book Title, Price, and Genre are required.');\n//     if(cleanedImages.length === 0) return showAlert('Validation Error', 'At least one cover image URL is required.');\n\n//     const newBook = {\n//       ...form,\n//       images: cleanedImages,\n//       price: Number(form.price),\n//       pages: Number(form.pages)\n//     };\n\n//     // Persist to backend if available. Use either editing._id or editing.id for updates.\n//     (async () => {\n//       try{\n//   let token = null;\n//   try{ token = localStorage.getItem('pt_admin_token'); if(token) token = JSON.parse(token); }catch(e){ /* ignore */ }\n//   const headers = { 'Content-Type': 'application/json' };\n//   if(token) headers['Authorization'] = `Bearer ${token}`;\n\n//         const API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:4000';\n\n//         // Determine if this is an update (has an id or _id) or a create\n//         const editingId = editing && (editing._id || editing.id);\n//         if(editingId){\n//           // update\n//           const res = await fetch(`${API_BASE}/api/books/${editingId}`, { method: 'PUT', headers, body: JSON.stringify(newBook) });\n//           if(!res.ok){\n//             const text = await res.text().catch(()=>res.statusText);\n//             throw new Error(text || 'Update failed');\n//           }\n//           // refresh list\n//           const remote = await fetch(`${API_BASE}/api/books`);\n//           const data = await remote.json();\n//           setBooks(data.map(b => ({ ...b, id: b._id || b.id })));\n//           setEditing(null);\n//           setForm(empty);\n//           showAlert('Saved', 'Book updated successfully.');\n//         } else {\n//           // create\n//           const res = await fetch(`${API_BASE}/api/books`, { method: 'POST', headers, body: JSON.stringify(newBook) });\n//           if(!res.ok){\n//             const text = await res.text().catch(()=>res.statusText);\n//             throw new Error(text || 'Create failed');\n//           }\n//           // refresh list\n//           const remote = await fetch(`${API_BASE}/api/books`);\n//           const data = await remote.json();\n//           setBooks(data.map(b => ({ ...b, id: b._id || b.id })));\n//           setForm(empty);\n//           showAlert('Saved', 'Book created successfully.');\n//         }\n//       }catch(err){\n//         // fallback to local behavior and surface an error\n//         showAlert('Save Failed', err.message || 'Failed to persist to server — saved locally as a fallback.');\n//         // If server says Unauthorized (expired/invalid JWT), force logout so user can re-login\n//         const msg = (err.message || '').toLowerCase();\n//         if(msg.includes('unauthorized') || msg.includes('jwt') || msg.includes('invalid token')){\n//           showAlert('Session Expired', 'Your admin session is invalid. Please log in again.');\n//           try{ logoutAdmin(navigate, true); }catch(e){}\n//         }\n//         if(editing){\n//           const idKey = editing.id || editing._id;\n//           setBooks(prev => prev.map(b => b.id === idKey ? {...newBook, id: idKey} : b));\n//           setEditing(null);\n//         }\n//         else {\n//           setBooks(prev => [{...newBook, id:`b${Date.now()}`}, ...prev]);\n//           setForm(empty);\n//         }\n//       }\n//     })();\n//   }\n\n//   function remove(id){\n//     showAlert('Confirm Deletion', 'Are you sure you want to delete this book? This action cannot be undone.', async () => {\n//       try{\n//   let token = null;\n//   try{ token = localStorage.getItem('pt_admin_token'); if(token) token = JSON.parse(token); }catch(e){ /* ignore */ }\n//   const headers = {};\n//   if(token) headers['Authorization'] = `Bearer ${token}`;\n//         const API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:4000';\n\n//         // try server delete\n//         const res = await fetch(`${API_BASE}/api/books/${id}`, { method: 'DELETE', headers });\n//         if(!res.ok){\n//           const text = await res.text().catch(()=>res.statusText);\n//           throw new Error(text || 'Delete failed');\n//         }\n//         const remote = await fetch(`${API_BASE}/api/books`);\n//         const data = await remote.json();\n//         setBooks(data.map(b => ({ ...b, id: b._id || b.id })));\n//         showAlert('Deleted', 'Book deleted successfully.');\n//       }catch(err){\n//         // fallback local\n//         showAlert('Delete Failed', err.message || 'Failed to delete on server — deleted locally.');\n//         const msg = (err.message || '').toLowerCase();\n//         if(msg.includes('unauthorized') || msg.includes('jwt') || msg.includes('invalid token')){\n//           showAlert('Session Expired', 'Your admin session is invalid. Please log in again.');\n//           try{ logoutAdmin(navigate, true); }catch(e){}\n//           return;\n//         }\n//         setBooks(prev => prev.filter(b=>b.id!==id));\n//       }\n//     });\n//   }\n\n//   const previewImage = form.images?.[0] || 'https://placehold.co/400x600?text=Cover';\n\n//   // Mark a book as featured (only one book should be featured at a time)\n//   async function toggleFeatured(id) {\n//     // Try server-side toggle first, fallback to local update\n//     try{\n//       await api.toggleFeatured(id);\n//       // refresh list from server\n//       const remote = await api.fetchBooks();\n//       if(Array.isArray(remote)) setBooks(remote.map(b => ({ ...b, id: b._id || b.id })));\n//       showAlert('Updated', 'Featured book updated.');\n//     }catch(err){\n//       // fallback: optimistic local update\n//       setBooks(prev => {\n//         const clicked = prev.find(b => b.id === id);\n//         const makeFeatured = !(clicked && clicked.featured);\n//         const updated = prev.map(b => ({ ...b, featured: makeFeatured && b.id === id }));\n//         return updated;\n//       });\n//       const clicked = books.find(b => b.id === id);\n//       if (clicked && clicked.featured) showAlert('Updated', `${clicked.title} is no longer featured.`);\n//       else if (clicked) showAlert('Updated', `${clicked.title} is now the featured book.`);\n//     }\n//   }\n\n//   // --- About Page / Author editor state ---\n//   const emptyAuthorForm = {\n//     name: '',\n//     tagline: '',\n//     bio: '',\n//     avatar: '',\n//     social: { instagram: '', goodreads: '', twitter: '' },\n//     stats: []\n//   };\n\n//   const [authorForm, setAuthorForm] = useState(author || emptyAuthorForm);\n\n//   useEffect(() => {\n//     setAuthorForm(author || emptyAuthorForm);\n//   }, [author]);\n\n//   function handleSocialChange(key, value) {\n//     setAuthorForm(prev => ({ ...prev, social: { ...prev.social, [key]: value } }));\n//   }\n\n//   function handleStatChange(index, field, value) {\n//     const newStats = [...(authorForm.stats || [])];\n//     newStats[index] = { ...newStats[index], [field]: value };\n//     setAuthorForm(prev => ({ ...prev, stats: newStats }));\n//   }\n\n//   function addStat() {\n//     setAuthorForm(prev => ({ ...prev, stats: [ ...(prev.stats || []), { label: '', value: '' } ] }));\n//   }\n\n//   function removeStat(index) {\n//     setAuthorForm(prev => ({ ...prev, stats: prev.stats.filter((_, i) => i !== index) }));\n//   }\n\n//   function saveAuthor() {\n//     if (!authorForm.name || !authorForm.bio) return showAlert('Validation Error', 'Author Name and Bio are required.');\n//     const cleanedStats = (authorForm.stats || []).map(s => ({ label: (s.label||'').trim(), value: (s.value||'').toString().trim() })).filter(s => s.label || s.value);\n//     const newAuthor = { ...authorForm, stats: cleanedStats };\n//     // Try saving to backend, fall back to local state\n//     (async () => {\n//       try{\n//         const saved = await api.saveAuthor(newAuthor);\n//         if(saved) setAuthor(saved);\n//         else setAuthor(newAuthor);\n//         showAlert('Saved', 'About page content updated successfully.');\n//       }catch(err){\n//         setAuthor(newAuthor);\n//         showAlert('Saved (local)', 'Saved locally but failed to persist to server.');\n//       }\n//     })();\n//   }\n\n//   // --- Blogs admin state and helpers ---\n//   const [blogs, setBlogs] = useState([]);\n//   const [blogEditing, setBlogEditing] = useState(null);\n//   const blogEmpty = { title: '', slug: '', image: '', excerpt: '', content: '', published: true, publishedAt: new Date().toISOString().slice(0,10), tags: [], externalLink: '', author: (author && author.name) || '' };\n//   const [blogForm, setBlogForm] = useState(blogEmpty);\n//   const [previewOpen, setPreviewOpen] = useState(false);\n//   const [blogUploading, setBlogUploading] = useState(false);\n\n//   function slugify(s=''){\n//     return s.toString().toLowerCase().trim()\n//       .replace(/[^a-z0-9\\s-]/g, '')\n//       .replace(/\\s+/g, '-')\n//       .replace(/-+/g, '-');\n//   }\n\n//   useEffect(()=>{\n//     (async ()=>{\n//       try{ const remote = await api.fetchBlogs(); if(Array.isArray(remote)) setBlogs(remote.map(b=>({ ...b, id: b._id || b.id }))); }catch(e){}\n//     })();\n//   }, []);\n\n//   useEffect(()=>{ if(blogEditing) setBlogForm({...blogEditing}); else setBlogForm(blogEmpty); }, [blogEditing]);\n\n//   async function saveBlog(){\n//     if(!blogForm.title) return showAlert('Validation Error', 'Title is required');\n//     try{\n//       // ensure slug, tags array, and publishedAt are set correctly\n//       const payload = { ...blogForm };\n//       payload.slug = payload.slug || slugify(payload.title || '');\n//       if(typeof payload.tags === 'string') payload.tags = payload.tags.split(',').map(t=>t.trim()).filter(Boolean);\n//       if(!payload.publishedAt) payload.publishedAt = new Date().toISOString();\n\n//       if(blogEditing && (blogEditing._id || blogEditing.id)){\n//         const id = blogEditing._id || blogEditing.id;\n//         await api.updateBlog(id, payload);\n//   const remote = await api.fetchBlogs(); if(Array.isArray(remote)) { setBlogs(remote.map(b=>({ ...b, id: b._id || b.id }))); window.dispatchEvent(new Event('blogs-updated')); }\n//         setBlogEditing(null); setBlogForm(blogEmpty);\n//         showAlert('Saved', 'Blog updated');\n//       } else {\n//         await api.createBlog(payload);\n//   const remote = await api.fetchBlogs(); if(Array.isArray(remote)) { setBlogs(remote.map(b=>({ ...b, id: b._id || b.id }))); window.dispatchEvent(new Event('blogs-updated')); }\n//         setBlogForm(blogEmpty);\n//         showAlert('Saved', 'Blog created');\n//       }\n//     }catch(err){\n//       showAlert('Save Failed', err.message || 'Failed to save blog');\n//     }\n//   }\n\n//   async function editBlog(blog){\n//     // fetch full blog from server in case list response is truncated\n//     try{\n//       const id = blog._id || blog.id;\n//       if(!id) return setBlogEditing(blog);\n//       const remote = await api.fetchBlog(id);\n//       // normalize tags to array for the form\n//       if(remote && remote.tags && !Array.isArray(remote.tags)){\n//         remote.tags = (remote.tags||'').toString().split(',').map(t=>t.trim()).filter(Boolean);\n//       }\n//       setBlogEditing(remote || blog);\n//     }catch(err){\n//       // fallback to using provided object\n//       setBlogEditing(blog);\n//       showAlert && showAlert('Load Failed', 'Could not load full blog details — using list data.');\n//     }\n//   }\n\n//   function removeBlogPrompt(blog){\n//     showAlert('Confirm Deletion', 'Delete this blog post? This cannot be undone.', async ()=>{\n//       try{\n//         const id = blog._id || blog.id;\n//         await api.deleteBlog(id);\n//         const remote = await api.fetchBlogs(); if(Array.isArray(remote)) setBlogs(remote.map(b=>({ ...b, id: b._id || b.id })));\n//         window.dispatchEvent(new Event('blogs-updated'));\n//         showAlert('Deleted', 'Blog deleted');\n//       }catch(err){\n//         showAlert('Delete Failed', err.message || 'Failed to delete blog');\n//       }\n//     });\n//   }\n\n//   // Handle image file input (convert to base64 data URL)\n//   function handleImageFile(e){\n//     const f = e.target.files && e.target.files[0];\n//     if(!f) return;\n\n//     // show an immediate local preview while uploading\n//     const localPreview = URL.createObjectURL(f);\n//     setBlogForm(prev => ({ ...prev, image: localPreview }));\n//     setBlogUploading(true);\n\n//     // upload to server endpoint /api/uploads\n//     (async () => {\n//       const API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:4000';\n//       const fd = new FormData();\n//       fd.append('file', f);\n//       try{\n//         // include Authorization header if available\n//         const headers = {};\n//         try{ let token = localStorage.getItem('pt_admin_token'); if(token) token = JSON.parse(token); if(token) headers['Authorization'] = `Bearer ${token}`; }catch(e){}\n//         const res = await fetch(`${API_BASE}/api/uploads`, { method: 'POST', headers, body: fd });\n//         if(!res.ok){\n//           const text = await res.text().catch(()=>res.statusText);\n//           throw new Error(text || 'Upload failed');\n//         }\n//         const data = await res.json();\n//         if(data && data.url){\n//           // replace preview with server-hosted URL\n//           setBlogForm(prev => ({ ...prev, image: data.url }));\n//         } else {\n//           throw new Error('Invalid upload response');\n//         }\n//       }catch(err){\n//         // If upload fails, fall back to a base64 preview and notify the admin\n//         const reader = new FileReader();\n//         reader.onload = () => {\n//           setBlogForm(prev => ({ ...prev, image: reader.result }));\n//         };\n//         reader.readAsDataURL(f);\n//         try{ showAlert('Upload Failed', err.message || 'Image upload failed; using local preview.'); }catch(e){}\n//       } finally {\n//         setBlogUploading(false);\n//         // revoke the temporary object URL after a short delay to ensure the image element has loaded it\n//         setTimeout(()=>{ try{ URL.revokeObjectURL(localPreview); }catch(e){} }, 3000);\n//       }\n//     })();\n//   }\n\n//   // --- Simple URL validation for avatar and social links ---\n//   function isValidUrl(u){\n//     if(!u) return true; // allow empty\n//     try { const url = new URL(u); return url.protocol === 'http:' || url.protocol === 'https:'; } catch { return false; }\n//   }\n\n//   const avatarValid = isValidUrl(authorForm.avatar);\n//   const instagramValid = isValidUrl(authorForm.social?.instagram);\n//   const goodreadsValid = isValidUrl(authorForm.social?.goodreads);\n//   const twitterValid = isValidUrl(authorForm.social?.twitter);\n\n\n//   function currency(n){ return `₹${Number(n).toLocaleString('en-IN')}` }\n\n//   return (\n//     <motion.main initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className=\"max-w-7xl mx-auto px-6 py-12\">\n//       <div className=\"flex items-center justify-between mb-6\">\n//         <h2 className=\"font-serif text-3xl text-amber-600 dark:text-amber-500\">Admin Dashboard</h2>\n//         <div className=\"flex flex-wrap gap-2\">\n//           <button onClick={() => { setActiveTab('books'); }} className={`px-4 py-2 rounded ${activeTab==='books' ? 'bg-amber-600 text-white' : 'bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-700'}`}>Books</button>\n//           <button onClick={() => { setActiveTab('about'); }} className={`px-4 py-2 rounded ${activeTab==='about' ? 'bg-emerald-600 text-white' : 'bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-700'}`}>About Editor</button>\n//           <button onClick={() => { setActiveTab('blogs'); }} className={`px-4 py-2 rounded ${activeTab==='blogs' ? 'bg-pink-600 text-white' : 'bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-700'}`}>Blogs</button>\n//           <button onClick={() => { setActiveTab('orders'); loadOrderCounts(); }} className={`px-4 py-2 rounded ${activeTab==='orders' ? 'bg-indigo-600 text-white' : 'bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-700'}`}>\n//             Orders\n//             {(orderCount > 0 || queuedCount > 0) && (\n//               <span className=\"ml-2 inline-flex items-center gap-1\">\n//                 {orderCount > 0 && <span className=\"px-2 py-0.5 bg-rose-500 text-white rounded-full text-xs\">{orderCount}</span>}\n//                 {queuedCount > 0 && <span className=\"px-2 py-0.5 bg-amber-500 text-white rounded-full text-xs\">Q:{queuedCount}</span>}\n//               </span>\n//             )}\n//           </button>\n//           <button onClick={() => { setActiveTab('books'); setEditing(null); setForm && setForm(empty); setTimeout(()=>{ if(asideRef.current) asideRef.current.scrollIntoView({behavior:'smooth', block:'center'}); }, 100); }} className=\"px-4 py-2 rounded bg-slate-900 text-white\">Add Book</button>\n//         </div>\n//       </div>\n      \n//       {activeTab === 'books' && (\n//       <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n//         <div className=\"lg:col-span-2\">\n//           <h3 className=\"text-xl mb-4 font-semibold\">Book List ({books.length})</h3>\n//           <div className=\"grid gap-3\">\n//             {books.map(b=> (\n//               <div key={b.id} className=\"p-3 border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-xl flex flex-col sm:flex-row items-start sm:items-center justify-between shadow-sm\">\n//                 <div className=\"flex items-start sm:items-center gap-3 w-full\">\n//                   <img src={b.images?.[0]} alt={b.title} className=\"w-12 h-18 sm:w-16 sm:h-24 object-cover rounded-md shadow-md flex-shrink-0\" onError={(e) => {e.target.onerror = null; e.target.src='https://placehold.co/400x600?text=Img'}}/>\n//                   <div className=\"flex-1 min-w-0\">\n//                     <div className=\"font-semibold text-base sm:text-lg truncate\">{b.title}</div>\n//                     <div className=\"text-sm text-slate-500 truncate\">{b.genre} • {currency(b.price)}</div>\n//                   </div>\n//                 </div>\n//                 <div className=\"flex flex-col sm:flex-row gap-2 mt-3 sm:mt-0\">\n//                   {/* Featured toggle */}\n//                   {b.featured ? (\n//                     <button onClick={() => toggleFeatured(b.id)} title=\"Unfeature\" className=\"px-3 py-1 rounded-lg bg-amber-500 text-white text-sm flex items-center gap-2\">\n//                       <span>★</span>\n//                       <span className=\"hidden sm:inline\">Featured</span>\n//                     </button>\n//                   ) : (\n//                     <button onClick={() => toggleFeatured(b.id)} title=\"Mark as featured\" className=\"px-3 py-1 rounded-lg border border-amber-500 text-amber-600 hover:bg-amber-50 transition text-sm\">Mark Featured</button>\n//                   )}\n//                   <button onClick={()=>setEditing(b)} className=\"px-3 py-1 border border-amber-500 text-amber-600 dark:text-amber-500 rounded-lg hover:bg-amber-50 transition text-sm\">Edit</button>\n//                   <button onClick={()=>remove(b.id)} className=\"px-3 py-1 border border-rose-500 text-rose-500 rounded-lg hover:bg-rose-50 transition text-sm\">Delete</button>\n//                 </div>\n//               </div>\n//             ))}\n//           </div>\n//         </div>\n\n//   <aside ref={asideRef} className=\"p-6 border border-slate-300 dark:border-slate-700 rounded-xl bg-white dark:bg-slate-800 shadow-lg h-fit md:sticky md:top-20\">\n//           <h3 className=\"text-xl font-semibold mb-4\">{editing? 'Edit Book' : 'Add New Book'}</h3>\n//           <div className=\"space-y-3\">\n//             <input value={form.title} onChange={e=>setForm({...form, title:e.target.value})} placeholder=\"Title\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" required />\n//             <input value={form.subtitle} onChange={e=>setForm({...form, subtitle:e.target.value})} placeholder=\"Subtitle\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n//             <input type=\"number\" value={form.price} onChange={e=>setForm({...form, price:e.target.value})} placeholder=\"Price (₹)\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" required />\n            \n//             <input \n//                 value={form.genre} \n//                 onChange={e=>setForm({...form, genre:e.target.value})} \n//                 placeholder=\"Genre (e.g., Fiction, Poetry, Thriller)\" \n//                 className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" \n//                 list=\"genre-suggestions\"\n//                 required\n//             />\n//             <datalist id=\"genre-suggestions\">\n//                 {existingGenres.map(genre => <option key={genre} value={genre} />)}\n//             </datalist>\n\n//             <input type=\"number\" value={form.pages} onChange={e=>setForm({...form, pages:e.target.value})} placeholder=\"Pages\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n//             <input value={form.isbn} onChange={e=>setForm({...form, isbn:e.target.value})} placeholder=\"ISBN\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n//             <input type=\"date\" value={form.pubDate} onChange={e=>setForm({...form, pubDate:e.target.value})} placeholder=\"Publication Date\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n//             <textarea value={form.description} onChange={e=>setForm({...form, description:e.target.value})} placeholder=\"Description\" className=\"p-3 border rounded-lg w-full h-32 dark:bg-slate-900\" />\n\n//             <h4 className=\"pt-3 font-semibold text-sm text-slate-500 dark:text-slate-400\">Book Images (First is Cover)</h4>\n//             <div className=\"space-y-3\">\n//               {form.images.map((image, index) => (\n//                 <div key={index} className=\"flex gap-2\">\n//                   <input\n//                     value={image}\n//                     onChange={e => handleImageChange(index, e.target.value)}\n//                     placeholder={index === 0 ? \"Primary Cover URL (Required)\" : `Image URL ${index + 1}`}\n//                     className=\"p-3 border rounded-lg w-full dark:bg-slate-900\"\n//                     required={index === 0}\n//                   />\n//                   <button\n//                     onClick={() => removeImage(index)}\n//                     className={`px-3 py-1 rounded-lg transition text-white ${index === 0 ? 'bg-slate-400 cursor-not-allowed' : 'bg-rose-500 hover:bg-rose-700'}`}\n//                     disabled={index === 0}\n//                     type=\"button\"\n//                     title={index === 0 ? \"Cannot remove primary cover\" : \"Remove Image\"}\n//                   >\n//                     ✕\n//                   </button>\n//                 </div>\n//               ))}\n//               <button onClick={addImage} className=\"inline-flex items-center gap-2 px-3 py-2 bg-slate-900 hover:bg-slate-700 text-white rounded-lg transition\" type=\"button\">\n//                 <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\"/></svg>\n//                 Add Image\n//               </button>\n//             </div>\n//           </div>\n//           <div className=\"flex flex-col sm:flex-row gap-3 mt-4\">\n//             <button onClick={save} className=\"w-full sm:w-auto px-5 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-semibold transition\">Save</button>\n//             <button onClick={()=>{ setEditing(null); setForm(empty); }} className=\"w-full sm:w-auto px-5 py-2 border border-slate-400 dark:border-slate-600 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 transition\">\n//               {editing ? 'Cancel Edit' : 'Clear Form'}\n//             </button>\n//           </div>\n\n//           {form.title && (\n//             <div className=\"mt-6 pt-4 border-t border-dashed border-slate-300 dark:border-slate-700\">\n//               <h5 className=\"font-semibold text-lg mb-3\">Live Card Preview</h5>\n//               <div className=\"p-3 border border-slate-300 dark:border-slate-700 rounded-xl flex gap-4 items-center\">\n//                 <img src={previewImage} alt=\"preview\" className=\"w-20 h-28 object-cover rounded-md shadow\" onError={(e) => { e.target.onerror = null; e.target.src = 'https://placehold.co/400x600?text=Cover Not Found'; }} />\n//                 <div>\n//                   <div className=\"font-bold text-lg\">{form.title}</div>\n//                   <div className=\"text-sm text-slate-500\">{form.genre} • {form.pages || '??'} pages</div>\n      \n              \n//                 </div>\n//               </div>\n//             </div>\n//           )}\n          \n//           <div className=\"mt-6 pt-4 border-t border-dashed border-slate-300 dark:border-slate-700\">\n//              <button onClick={() => logoutAdmin(navigate)} className=\"w-full px-5 py-2 bg-rose-600 hover:bg-rose-700 text-white rounded-lg font-semibold transition shadow-md\">Logout Admin</button>\n//           </div>\n//         </aside>\n//         </div>\n//         )}\n\n//         {activeTab === 'orders' && (\n//           <div className=\"mt-4\">\n//             <OrdersAdmin />\n//           </div>\n//         )}\n\n//       {activeTab === 'blogs' && (\n//         <div className=\"mt-8 grid grid-cols-1 lg:grid-cols-10 gap-8 items-start\">\n//           <div className=\"lg:col-span-4\">\n//             <h3 className=\"text-xl mb-4 font-semibold\">Blog Posts ({blogs.length})</h3>\n//             <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n//               {blogs.map(b => (\n//                 <div key={b.id} className=\"p-4 border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-xl shadow-sm flex flex-col sm:flex-row gap-4 items-stretch min-h-[12rem] box-border\">\n//                   <div className=\"w-full sm:w-1/2 flex-shrink-0 flex items-center\">\n//                     <img src={b.image || 'https://placehold.co/320x200?text=Blog'} alt={b.title} className=\"w-full h-44 sm:h-40 md:h-48 object-cover rounded-md shadow-sm\" onError={(e)=>{e.target.onerror=null; e.target.src='https://placehold.co/320x200?text=Img'}} />\n//                   </div>\n//                   <div className=\"flex-1 flex flex-col justify-between min-w-0\">\n//                     <div>\n//                       <div className=\"font-semibold text-lg leading-tight truncate break-words\">{b.title}</div>\n//                       <div className=\"text-sm text-slate-500 mt-2\" style={{ display: '-webkit-box', WebkitLineClamp: 3, WebkitBoxOrient: 'vertical', overflow: 'hidden', wordBreak: 'break-word' }}>{b.excerpt || ''}</div>\n//                     </div>\n//                     <div className=\"mt-4 flex items-center justify-between gap-3\">\n//                       <div className={`text-sm px-2 py-1 rounded ${b.published ? 'bg-emerald-600 text-white' : 'bg-slate-200 text-slate-700'}`}>{b.published ? 'Published' : 'Draft'}</div>\n//                       <div className=\"flex items-center gap-2 flex-shrink-0\">\n//                         <button onClick={() => editBlog(b)} className=\"px-3 py-1 border border-amber-500 text-amber-600 rounded-lg text-sm\">Edit</button>\n//                         <button onClick={() => removeBlogPrompt(b)} className=\"px-3 py-1 border border-rose-500 text-rose-500 rounded-lg text-sm\">Delete</button>\n//                       </div>\n//                     </div>\n//                   </div>\n//                 </div>\n//               ))}\n//             </div>\n//           </div>\n\n//           <aside className=\"p-6 border border-slate-300 dark:border-slate-700 rounded-xl bg-white dark:bg-slate-800 shadow-lg h-fit lg:col-span-6 lg:sticky lg:top-20 relative z-10 max-h-[calc(100vh-6rem)] overflow-auto\">\n//             <h3 className=\"text-xl font-semibold mb-4\">{blogEditing ? 'Edit Blog' : 'Add Blog'}</h3>\n//             <div className=\"space-y-3\">\n//               <input value={blogForm.title} onChange={e=>setBlogForm({...blogForm, title:e.target.value, slug: slugify(e.target.value)})} placeholder=\"Title\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n\n//               <div className=\"grid grid-cols-1 gap-2\">\n//                 <div className=\"flex items-center gap-3\">\n//                   <div className=\"w-24 h-16 bg-slate-100 rounded overflow-hidden border\">\n//                     {blogForm.image ? <img src={blogForm.image} alt=\"featured\" className=\"w-full h-full object-cover\" /> : <div className=\"w-full h-full flex items-center justify-center text-xs text-slate-500\">No image</div>}\n//                   </div>\n//                   <div className=\"flex-1\">\n//                     <div className=\"flex items-center gap-2\">\n//                       <input type=\"file\" accept=\"image/*\" onChange={handleImageFile} className=\"text-sm text-slate-500\" />\n//                       {blogUploading && (\n//                         <div className=\"text-xs text-amber-600 flex items-center gap-2\">\n//                           <svg className=\"w-4 h-4 animate-spin\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n//                             <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" strokeOpacity=\"0.2\" />\n//                             <path d=\"M22 12a10 10 0 0 1-10 10\" stroke=\"currentColor\" strokeWidth=\"4\" strokeLinecap=\"round\" />\n//                           </svg>\n//                           <span>Uploading...</span>\n//                         </div>\n//                       )}\n//                     </div>\n//                     <input value={blogForm.image} onChange={e=>setBlogForm({...blogForm, image:e.target.value})} placeholder=\"Or image URL\" className=\"mt-2 p-2 border rounded w-full dark:bg-slate-900 text-sm\" />\n//                   </div>\n//                 </div>\n//               </div>\n\n//               <textarea value={blogForm.excerpt} onChange={e=>setBlogForm({...blogForm, excerpt:e.target.value})} placeholder=\"Short description / excerpt\" className=\"p-3 border rounded-lg w-full h-20 dark:bg-slate-900\" />\n\n//               <input value={(Array.isArray(blogForm.tags) ? blogForm.tags.join(', ') : blogForm.tags||'')} onChange={e=>setBlogForm({...blogForm, tags: e.target.value})} placeholder=\"Tags (comma-separated)\" className=\"p-2 border rounded w-full dark:bg-slate-900 text-sm\" />\n\n//               <input value={blogForm.externalLink||''} onChange={e=>setBlogForm({...blogForm, externalLink:e.target.value})} placeholder=\"External / embed link (optional)\" className=\"p-2 border rounded w-full dark:bg-slate-900 text-sm\" />\n\n//               <div className=\"flex gap-2\">\n//                 <label className=\"text-sm\">Publish Date</label>\n//                 <input type=\"date\" value={blogForm.publishedAt ? blogForm.publishedAt.slice(0,10) : new Date().toISOString().slice(0,10)} onChange={e=>setBlogForm({...blogForm, publishedAt: e.target.value})} className=\"p-2 border rounded ml-2\" />\n//               </div>\n\n//               <div>\n//                 <div className=\"text-sm font-medium mb-2\">Content</div>\n//                 <ReactQuill theme=\"snow\" value={blogForm.content || ''} onChange={val=>setBlogForm({...blogForm, content: val})} modules={{ toolbar: [[{ 'header': [1,2,3,false] }], ['bold','italic','underline','strike'], ['blockquote','code-block'], [{ 'list': 'ordered'}, { 'list': 'bullet' }], ['link','image'], ['clean'] ] }} formats={[ 'header','bold','italic','underline','strike','blockquote','code-block','list','bullet','link','image' ]} />\n//               </div>\n\n//               <label className=\"flex items-center gap-2 text-sm\"><input type=\"checkbox\" checked={!!blogForm.published} onChange={e=>setBlogForm({...blogForm, published: e.target.checked})} /> Published</label>\n//             </div>\n//             <div className=\"flex gap-3 mt-4\">\n//               <button onClick={saveBlog} className=\"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded\">{blogEditing ? 'Update' : 'Save'}</button>\n//               <button onClick={()=>setPreviewOpen(true)} className=\"px-4 py-2 border rounded\">Preview</button>\n//               {blogEditing && <button onClick={()=>removeBlogPrompt(blogEditing)} className=\"px-4 py-2 border border-rose-500 text-rose-600 rounded\">Delete</button>}\n//               <button onClick={()=>{ setBlogEditing(null); setBlogForm(blogEmpty); }} className=\"px-4 py-2 border rounded\">Cancel</button>\n//             </div>\n\n//             {previewOpen && (\n//               <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center\">\n//                 <div className=\"w-full max-w-3xl bg-white dark:bg-slate-800 p-6 rounded shadow-lg overflow-auto max-h-[90vh]\">\n//                   <div className=\"flex justify-between items-center mb-4\">\n//                     <h3 className=\"text-xl font-semibold\">Preview: {blogForm.title}</h3>\n//                     <button onClick={()=>setPreviewOpen(false)} className=\"px-3 py-1 border rounded\">Close</button>\n//                   </div>\n//                   {blogForm.image && <img src={blogForm.image} alt=\"preview\" className=\"w-full h-64 object-cover rounded mb-4\" />}\n//                   <div className=\"prose dark:prose-invert max-w-none\" dangerouslySetInnerHTML={{ __html: blogForm.content || `<p>${blogForm.excerpt||''}</p>` }} />\n//                 </div>\n//               </div>\n//             )}\n//           </aside>\n//         </div>\n//       )}\n\n//   {/* About Page Editor (Admin) */}\n//   {activeTab === 'about' && (\n//     <div className=\"mt-8 p-6 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700\">\n//       <div className=\"flex items-start justify-between mb-4\">\n//         <h3 className=\"font-serif text-2xl\">About Page Editor</h3>\n//         <div className=\"flex items-center gap-2\">\n//           <button onClick={saveAuthor} disabled={!avatarValid || !instagramValid || !goodreadsValid || !twitterValid || !authorForm.name || !authorForm.bio} className={`px-4 py-2 rounded ${(!avatarValid || !instagramValid || !goodreadsValid || !twitterValid || !authorForm.name || !authorForm.bio) ? 'bg-slate-400 cursor-not-allowed' : 'bg-emerald-600 hover:bg-emerald-700'} text-white`}>Save</button>\n//           <button onClick={()=>setAuthorForm(author || emptyAuthorForm)} className=\"px-4 py-2 rounded border\">Reset</button>\n//         </div>\n//       </div>\n\n//       <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n//         {/* Form column */}\n//         <div className=\"md:col-span-2 space-y-4\">\n//           <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n//             <div>\n//               <label className=\"text-sm font-medium mb-1 block\">Name</label>\n//               <input value={authorForm.name} onChange={e=>setAuthorForm({...authorForm, name:e.target.value})} placeholder=\"Author Name\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n\n//               <label className=\"text-sm font-medium mb-1 block mt-3\">Tagline</label>\n//               <input value={authorForm.tagline} onChange={e=>setAuthorForm({...authorForm, tagline:e.target.value})} placeholder=\"Short tagline\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n\n//               <label className=\"text-sm font-medium mb-1 block mt-3\">Avatar URL</label>\n//               <input value={authorForm.avatar} onChange={e=>setAuthorForm({...authorForm, avatar:e.target.value})} placeholder=\"https://...\" className=\"p-3 border rounded-lg w-full dark:bg-slate-900\" />\n//               {!avatarValid && <div className=\"text-rose-500 text-xs mt-1\">Avatar must be a valid http(s) URL</div>}\n//             </div>\n\n//             <div>\n//               <label className=\"text-sm font-medium mb-1 block\">Short Bio</label>\n//               <textarea value={authorForm.bio} onChange={e=>setAuthorForm({...authorForm, bio:e.target.value})} placeholder=\"A short author bio\" className=\"p-3 border rounded-lg w-full h-36 dark:bg-slate-900\" />\n//             </div>\n//           </div>\n\n//           <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n//             <div>\n//               <div className=\"text-sm font-medium mb-2\">Social Links</div>\n//               <input value={authorForm.social?.instagram || ''} onChange={e=>handleSocialChange('instagram', e.target.value)} placeholder=\"Instagram URL\" className=\"p-2 border rounded-lg w-full dark:bg-slate-900 mb-2\" />\n//               {!instagramValid && <div className=\"text-rose-500 text-xs mb-2\">Must be a valid http(s) URL</div>}\n\n//               <input value={authorForm.social?.goodreads || ''} onChange={e=>handleSocialChange('goodreads', e.target.value)} placeholder=\"Goodreads URL\" className=\"p-2 border rounded-lg w-full dark:bg-slate-900 mb-2\" />\n//               {!goodreadsValid && <div className=\"text-rose-500 text-xs mb-2\">Must be a valid http(s) URL</div>}\n\n//               <input value={authorForm.social?.twitter || ''} onChange={e=>handleSocialChange('twitter', e.target.value)} placeholder=\"Twitter URL\" className=\"p-2 border rounded-lg w-full dark:bg-slate-900\" />\n//               {!twitterValid && <div className=\"text-rose-500 text-xs mt-1\">Must be a valid http(s) URL</div>}\n//             </div>\n\n//             <div>\n//               <div className=\"flex items-center justify-between mb-2\">\n//                 <div className=\"text-sm font-medium\">Milestones / Stats</div>\n//                 <button onClick={addStat} type=\"button\" className=\"px-2 py-1 bg-slate-900 text-white rounded text-sm\">Add Stat</button>\n//               </div>\n//               <div className=\"space-y-2\">\n//                 {(authorForm.stats || []).map((s, idx) => (\n//                   <div key={idx} className=\"flex gap-2\">\n//                     <input value={s.label} onChange={e=>handleStatChange(idx, 'label', e.target.value)} placeholder=\"Label (e.g., Books Published)\" className=\"p-2 border rounded-lg w-1/2 dark:bg-slate-900\" />\n//                     <input value={s.value} onChange={e=>handleStatChange(idx, 'value', e.target.value)} placeholder=\"Value (e.g., 7)\" className=\"p-2 border rounded-lg w-1/3 dark:bg-slate-900\" />\n//                     <button onClick={()=>removeStat(idx)} type=\"button\" className=\"px-2 py-1 bg-rose-500 text-white rounded\">✕</button>\n//                   </div>\n//                 ))}\n//                 {!(authorForm.stats || []).length && <div className=\"text-sm text-slate-500\">No stats yet — click Add Stat to create one.</div>}\n//               </div>\n//             </div>\n//           </div>\n//         </div>\n\n//         {/* Preview column */}\n//         <div className=\"p-4 bg-slate-50 dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-700\">\n//           <div className=\"flex flex-col items-center text-center\">\n//             <img src={authorForm.avatar || 'https://placehold.co/160x160?text=Avatar'} alt=\"preview avatar\" className=\"w-28 h-28 rounded-full object-cover mb-3\" onError={(e)=>{e.target.onerror=null; e.target.src='https://placehold.co/160x160?text=Avatar'}} />\n//             <div className=\"font-serif text-xl font-semibold\">{authorForm.name || 'Author Name'}</div>\n//             <div className=\"text-sm text-slate-500\">{authorForm.tagline || 'Tagline goes here'}</div>\n//             <p className=\"mt-3 text-sm text-slate-600 dark:text-slate-400\">{authorForm.bio || 'Short bio preview will appear here as you type.'}</p>\n//             <div className=\"mt-3 flex gap-2\">\n//               {authorForm.social?.instagram && <a href={authorForm.social.instagram} target=\"_blank\" rel=\"noreferrer\" className={`text-xs px-2 py-1 rounded ${instagramValid? 'bg-amber-500 text-white': 'bg-rose-200 text-rose-700'}`}>Instagram</a>}\n//               {authorForm.social?.goodreads && <a href={authorForm.social.goodreads} target=\"_blank\" rel=\"noreferrer\" className={`text-xs px-2 py-1 rounded ${goodreadsValid? 'bg-amber-500 text-white': 'bg-rose-200 text-rose-700'}`}>Goodreads</a>}\n//               {authorForm.social?.twitter && <a href={authorForm.social.twitter} target=\"_blank\" rel=\"noreferrer\" className={`text-xs px-2 py-1 rounded ${twitterValid? 'bg-amber-500 text-white': 'bg-rose-200 text-rose-700'}`}>Twitter</a>}\n//             </div>\n//             {authorForm.stats?.length > 0 && (\n//               <div className=\"mt-4 grid grid-cols-2 gap-2 w-full\">\n//                 {authorForm.stats.map((s, i) => (\n//                   <div key={i} className=\"p-2 bg-white dark:bg-slate-800 rounded text-center border\">\n//                     <div className=\"text-2xl font-bold text-amber-500\">{s.value || '—'}</div>\n//                     <div className=\"text-xs text-slate-500\">{s.label || 'Stat'}</div>\n//                   </div>\n//                 ))}\n//               </div>\n//             )}\n//           </div>\n//         </div>\n//       </div>\n//     </div>\n//   )}\n\n//     </motion.main>\n//   );\n// }\nimport React, { useState, useEffect } from \"react\";\nimport api from \"../lib/api\";\nimport { useNavigate } from \"react-router-dom\";\nimport { motion } from \"framer-motion\";\nimport OrdersAdmin from \"./OrdersAdmin\";\nimport ReactMarkdown from \"react-markdown\";\nimport remarkGfm from \"remark-gfm\";\nimport ReactQuill from \"react-quill\";\nimport \"react-quill/dist/quill.snow.css\";\n\nexport default function Admin({\n  books,\n  setBooks,\n  showAlert,\n  logoutAdmin,\n  author,\n  setAuthor,\n}) {\n  const navigate = useNavigate();\n  const [orderCount, setOrderCount] = React.useState(0);\n  const [queuedCount, setQueuedCount] = React.useState(0);\n  const [editing, setEditing] = useState(null);\n  const [activeTab, setActiveTab] = useState(\"books\");\n  const asideRef = React.createRef();\n\n  // same DB logic preserved...\n\n  return (\n    <motion.main\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"max-w-7xl mx-auto px-4 sm:px-6 py-10 text-slate-800 dark:text-slate-100\"\n    >\n      {/* --- Top Header --- */}\n      <div className=\"sticky top-0 z-20 bg-gradient-to-r from-amber-50 to-emerald-50 dark:from-slate-800 dark:to-slate-900 p-4 rounded-xl shadow-md mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\n        <h2 className=\"text-2xl sm:text-3xl font-bold font-serif text-amber-600 dark:text-amber-400 tracking-wide\">\n          Admin Dashboard\n        </h2>\n\n        <div className=\"flex flex-wrap justify-start sm:justify-end gap-2\">\n          {[\n            { key: \"books\", label: \"Books\", color: \"amber\" },\n            { key: \"about\", label: \"About Editor\", color: \"emerald\" },\n            { key: \"blogs\", label: \"Blogs\", color: \"pink\" },\n            { key: \"orders\", label: \"Orders\", color: \"indigo\" },\n          ].map((tab) => (\n            <button\n              key={tab.key}\n              onClick={() => {\n                setActiveTab(tab.key);\n                if (tab.key === \"orders\") loadOrderCounts();\n              }}\n              className={`px-4 py-2 rounded-lg font-medium shadow-sm transition-all duration-200 ${\n                activeTab === tab.key\n                  ? `bg-${tab.color}-600 text-white`\n                  : \"bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-700 hover:shadow\"\n              }`}\n            >\n              {tab.label}\n              {tab.key === \"orders\" && (orderCount > 0 || queuedCount > 0) && (\n                <span className=\"ml-2 inline-flex gap-1\">\n                  {orderCount > 0 && (\n                    <span className=\"px-2 py-0.5 bg-rose-500 text-white rounded-full text-xs\">\n                      {orderCount}\n                    </span>\n                  )}\n                  {queuedCount > 0 && (\n                    <span className=\"px-2 py-0.5 bg-amber-500 text-white rounded-full text-xs\">\n                      Q:{queuedCount}\n                    </span>\n                  )}\n                </span>\n              )}\n            </button>\n          ))}\n\n          <button\n            onClick={() => {\n              setActiveTab(\"books\");\n              setEditing(null);\n              setForm(empty);\n              setTimeout(() => {\n                if (asideRef.current)\n                  asideRef.current.scrollIntoView({ behavior: \"smooth\" });\n              }, 100);\n            }}\n            className=\"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-700 shadow font-semibold transition\"\n          >\n            + Add Book\n          </button>\n        </div>\n      </div>\n\n      {/* --- Books Section --- */}\n      {activeTab === \"books\" && (\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10\">\n          <div className=\"lg:col-span-2 space-y-4\">\n            <h3 className=\"text-xl font-semibold border-b pb-2\">\n              Books ({books.length})\n            </h3>\n            <div className=\"grid gap-4\">\n              {books.map((b) => (\n                <div\n                  key={b.id}\n                  className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-xl shadow-sm hover:shadow-md transition-all duration-300\"\n                >\n                  <div className=\"flex items-center gap-4 w-full\">\n                    <img\n                      src={b.images?.[0]}\n                      alt={b.title}\n                      className=\"w-14 h-20 object-cover rounded-lg shadow\"\n                      onError={(e) => {\n                        e.target.src =\n                          \"https://placehold.co/400x600?text=Cover\";\n                      }}\n                    />\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"font-semibold text-lg truncate\">\n                        {b.title}\n                      </div>\n                      <div className=\"text-sm text-slate-500 truncate\">\n                        {b.genre} • ₹{Number(b.price).toLocaleString(\"en-IN\")}\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex gap-2 mt-3 sm:mt-0\">\n                    {b.featured ? (\n                      <button\n                        onClick={() => toggleFeatured(b.id)}\n                        className=\"px-3 py-1 rounded-lg bg-amber-500 text-white text-sm\"\n                      >\n                        ★ Featured\n                      </button>\n                    ) : (\n                      <button\n                        onClick={() => toggleFeatured(b.id)}\n                        className=\"px-3 py-1 rounded-lg border border-amber-500 text-amber-600 hover:bg-amber-50 text-sm\"\n                      >\n                        Mark Featured\n                      </button>\n                    )}\n                    <button\n                      onClick={() => setEditing(b)}\n                      className=\"px-3 py-1 border border-emerald-500 text-emerald-600 hover:bg-emerald-50 rounded-lg text-sm\"\n                    >\n                      Edit\n                    </button>\n                    <button\n                      onClick={() => remove(b.id)}\n                      className=\"px-3 py-1 border border-rose-500 text-rose-500 hover:bg-rose-50 rounded-lg text-sm\"\n                    >\n                      Delete\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* --- Right Panel --- */}\n          <aside\n            ref={asideRef}\n            className=\"p-6 border border-slate-300 dark:border-slate-700 rounded-xl bg-gradient-to-b from-white to-slate-50 dark:from-slate-800 dark:to-slate-900 shadow-xl h-fit sticky top-24\"\n          >\n            <h3 className=\"text-lg font-semibold mb-4 text-amber-600 dark:text-amber-400\">\n              {editing ? \"Edit Book\" : \"Add New Book\"}\n            </h3>\n\n            {/* all form inputs remain same */}\n            {/* beautify inputs using consistent padding & dark styles */}\n          </aside>\n        </div>\n      )}\n\n      {activeTab === \"orders\" && (\n        <div className=\"mt-8\">\n          <OrdersAdmin />\n        </div>\n      )}\n\n      {activeTab === \"blogs\" && (\n        <div className=\"mt-8\">\n          {/* Blog UI area can be styled similarly */}\n        </div>\n      )}\n    </motion.main>\n  );\n}\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,GAAG,MAAM,YAAY;AAC5B,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,MAAM,QAAQ,eAAe;AACtC,OAAOC,WAAW,MAAM,eAAe;AACvC,OAAOC,aAAa,MAAM,gBAAgB;AAC1C,OAAOC,SAAS,MAAM,YAAY;AAClC,OAAOC,UAAU,MAAM,aAAa;AACpC,OAAO,iCAAiC;AA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}